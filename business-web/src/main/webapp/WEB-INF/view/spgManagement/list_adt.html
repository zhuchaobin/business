<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
    <meta
            content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
            name="viewport"/>
    <title>无模版</title>
    <link rel="stylesheet"
          th:href="@{/resources/bootstrap/css/bootstrap.min.css}"/>
    <link rel="stylesheet"
          th:href="@{/resources/dist/css/skins/_all-skins.css}"/>
    <link rel="stylesheet" th:href="@{/resources/dist/css/AdminLTE.min.css}"/>
    <link rel="stylesheet"
          th:href="@{/resources/dist/css/font-awesome.min.css}"/>
    <link rel="stylesheet" th:href="@{/resources/dist/css/ionicons.min.css}"/>
    <link rel="stylesheet"
          th:href="@{/resources/plugins/bootstrapValidator/bootstrapValidator.min.css}"/>
    <link rel="stylesheet" th:href="@{/resources/e7/css/e7-0.2.css}"/>
    <link rel="stylesheet"
          th:href="@{/resources/e7/e7table/e7table-0.2.css}"/>
    <link rel="stylesheet"
          th:href="@{/resources/adminlte/dist/css/AdminLTE.css}"/>
    <link rel="stylesheet"
          th:href="@{/resources/adminlte/bootstrap/css/bootstrap.min.css}"/>
    <link rel="stylesheet"
          th:href="@{/resources/adminlte/plugins/iCheck/all.css}"/>
    <link rel="stylesheet" th:href="@{/resources/style.css}"/>
    <link rel="stylesheet"
          th:href="@{/resources/dist/kl-iconfont/iconfont.css}"/>
    <link rel="stylesheet"
          th:href="@{/resources/plugins/datetimepicker/css/bootstrap-datetimepicker.min.css}"/>
    <style type="text/css">
        .btn_small {
            display: inline-block;
            padding: 1px 10px;
            margin-bottom: 0;
            font-size: 14px;
            font-weight: 400;
            line-height: 1.42857143;
            text-align: center;
            white-space: nowrap;
            vertical-align: middle;
            -ms-touch-action: manipulation;
            touch-action: manipulation;
            cursor: pointer;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            background-image: none;
            border: 1px solid transparent;
            border-radius: 4px;
        }
    </style>
    
<!-- 页面背景图片 -->
<style type="text/css">
body {
	padding: 0;
	margin: 0;
	background: url(/resources/dist/img/page_bg.png) no-repeat;
	width: 100%;
	background-size: cover;
}
</style>
<link rel="stylesheet" th:href="@{/resources/css_zcb/common.css}" />
<!-- 自定义按钮样式 -->
    <link rel="stylesheet" th:href="@{/resources/css_zcb/button.css}"/>
    <link rel="stylesheet"
          th:href="@{/resources/bootstrap/css/bootstrap-table.min.css}"/>
</head>
<body>
<!-- 列表查询 start-->
<section class="content" id="main_search_detail">
    <!-- 条件查询 -->
    <div class="box box-info">
        <!-- 条件区域 -->
        <div class="box-body" style="padding-bottom: 0px;">
            <form class="form-horizontal" id="frm_query">
                <div class="flowlayout" id="div_criteria">
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="col-sm-4 control-label" for="">长约编号：</label>
                            <div class="col-sm-8">

                                <input class="form-control" id="arId" name="arId" placeholder="长约编号"/>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="col-sm-4 control-label" for="">订单编号：</label>
                            <div class="col-sm-8">
                                 <input class="form-control" id="ordrId" name="ordrId" placeholder="订单编号"/>
                            </div>
                        </div>
                    </div>


                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="col-sm-4 control-label" for="">发货编号：</label>
                            <div class="col-sm-8">
                                <input class="form-control" id="spgId" name="spgId" placeholder="发货编号"/>
                            </div>
                        </div>
                    </div>


                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="col-sm-4 control-label" for="">供应链：</label>
                            <div class="col-sm-8">
                                <select class="form-control" name="splchainCo">
                                    <option value="">请选择</option>
                                    <option th:each="model: ${splchainCoModels}"
                                            th:text="${model.name}" th:value="${model.id}"></option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="col-sm-4 control-label" for="">融资企业：</label>
                            <div class="col-sm-8">
                                <select class="form-control" name="fncEntp">
                                    <option value="">请选择</option>
                                    <option th:each="model: ${fncEntpModels}"
                                            th:text="${model.name}" th:value="${model.id}"></option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="col-sm-4 control-label" for="">供应商：</label>
                            <div class="col-sm-8">
                                <select class="form-control" name="ustrmSplr">
                                    <option value="">请选择</option>
                                    <option th:each="model: ${ustrmSplrModels}"
                                            th:text="${model.name}" th:value="${model.id}"></option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="col-sm-4 control-label" for="">类型：</label>
                            <div class="col-sm-8">

                                <select class="form-control" name="spgSt">
                                    <option value="">全部</option>
                                    <option value="01">退回件</option>
                                    <option value="10">草稿件</option>
                                    <option value="11">撤销件</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="col-sm-4 control-label" for="">关键字：</label>
                            <div class="col-sm-8">
                                <input class="form-control" id="keyWorlds" name="keyWorlds"
                                       placeholder="搜索关键字"/>
                            </div>
                        </div>
                    </div>


                </div>
            </form>
        </div>

        <!-- 按钮区域 -->
        <div class="box-footer" id="div_buttons"></div>
    </div>

    <!-- 信息列表 -->
    <div class="row">
        <div class="col-xs-12">
            <div class="box box-info">
                <div class="box-body table-responsive no-padding">
                    <table class="table table-hover" id="tbl_query"></table>
                </div>
            </div>
        </div>
    </div>

</section>
<!-- 列表查询 end-->

<!-- 详细信息 start-->
<section class="content" id="main_edit_detail" style="display: none;">
    <div class="box box-info" id="main_edit_detail_clapse">
        <div class="box-header with-border">
            <h4 class="text-info" id="main_edit_detail_title">发货信息</h4>
            <div class="box-tools pull-right">
                <button class="btn btn-box-tool" data-widget="collapse">
                    <i class="fa fa-minus" id="main_edit_detail_li"></i>
                </button>
            </div>
        </div>
        <div class="box-body">
            <form class="form-horizontal" id="frm_detail">
                <fieldset id='fld_detail'>
                    <div class="w-z-info">
                        <input id="fileId" name="fileUrl" type="hidden"> <input
                            id="fileToDeleteId" name="filesToDelete" type="hidden">
                        <input name="id" type="hidden" value=""/> <input name="arId"
                                                                         type="hidden" value=""/>

                        <div class="col-md-6 ">
                            <div class="form-group">
                                <label class="col-sm-4 control-label" for="">长约编号：</label>
                                <div class="col-sm-8 pull-right">
                                    <div class="col-xs-10" style="padding-left: 0px;">
                                        <input class="form-control" name="arId"
                                               placeholder="长约编号" value="2"/>
                                    </div>

                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-sm-4 control-label" for="">订单编号：</label>
                                <div class="col-sm-8 pull-right">
                                    <div class="col-xs-10" style="padding-left: 0px;">
                                        <input class="form-control" name="ordrId" placeholder="订单编号"
                                               value="2"/>
                                    </div>

                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-sm-4 control-label" for="">发货编号：</label>
                                <div class="col-sm-8">
                                    <div class="col-xs-10" style="padding-left: 0px;">
                                        <input class="form-control" name="spgId"
                                               placeholder="发货编号" value="2"/>
                                    </div>

                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-sm-4 control-label" for="">发货时间：</label>
                                <div class="col-sm-8">
                                    <div class="col-xs-10" style="padding-left: 0px;">
                                        <input class="form-control" name="spgTm" placeholder="发货时间"
                                               value="2"/>
                                    </div>

                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-sm-4 control-label" for="">发货人：</label>
                                <div class="col-sm-8">
                                    <div class="col-xs-10" style="padding-left: 0px;">
                                        <input class="form-control" name="spgPsn" placeholder="发货人"
                                               value="2"/>
                                    </div>

                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-sm-4 control-label" for="">发货人联系电话：</label>
                                <div class="col-sm-8">
                                    <div class="col-xs-10" style="padding-left: 0px;">
                                        <input class="form-control" name="spgPsnCtcTel" placeholder="发货人联系电话"
                                               value="2"/>
                                    </div>

                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-sm-4 control-label" for="">收货人：</label>
                                <div class="col-sm-8">
                                    <div class="col-xs-10" style="padding-left: 0px;">
                                        <input class="form-control" name="cnsgn" placeholder="收货人"
                                               value="2"/>
                                    </div>

                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-sm-4 control-label" for="">收货人联系电话：</label>
                                <div class="col-sm-8">
                                    <div class="col-xs-10" style="padding-left: 0px;">
                                        <input class="form-control" name="cnsgnCtcTel" placeholder="收货人联系电话"
                                               value="2"/>
                                    </div>

                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-sm-4 control-label" for="">目的地：</label>
                                <div class="col-sm-8">
                                    <div class="col-xs-10" style="padding-left: 0px;">
                                        <input class="form-control" name="ppsLnd" placeholder="目的地"
                                               value="2"/>
                                    </div>

                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-sm-4 control-label" for="">发货状态：</label>
                                <div class="col-sm-8">
                                    <div class="col-xs-10" style="padding-left: 0px;">
                                        <input class="form-control" name="spgSt" placeholder="发货状态"
                                               value="2"/>
                                    </div>

                                </div>
                            </div>
                        </div>


                        <div id="t7SpgDetail_div_hide">
                            <div class="col-md-12" style="padding-right: 15px;">
                                <!-- 订单明细部分 -->
                                <h4 class="text-info pull-left">发货明细</h4>
                            </div>
                            <div class="col-md-12"
                                 id="boot_table_div"
                                 style="padding-right: 15px; padding-top: 10px; display: none;">
                                <table align="center" class="table table-hover" data-toggle="table"
                                       id="boot-table" name="area"
                                       style="table-layout: fixed">
                                    <thead>
                                    <tr bgcolor="#337AB7">
									<th style="border-bottom: none;" data-field="ids">序号</th>										
										<th style="border-bottom: none;" data-field="pdNm">品名</th>
										<th style="border-bottom: none;" data-field="spec">规格</th>
										<th style="border-bottom: none;" data-field="modl">型号</th>
										<th style="border-bottom: none;" data-field="qlyStd">质量标准</th>
										<th style="border-bottom: none;" data-field="brnd">品牌</th>
										<th style="border-bottom: none;" data-field="pdFctr">生产厂家</th>
										<th style="border-bottom: none;" data-field="num">数量</th>
										<th style="border-bottom: none;" data-field="msunit">计量单位</th>
										<th style="border-bottom: none;" data-field="pdId">品名id</th>

                                    </tr>
                                    </thead>
                                    <!-- <tbody class="list">
                                </tbody> -->
                                </table>
                            </div>
                        </div>

                        <div class="row" id="query_ar_atch_div">
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label class="col-sm-2 control-label" for=""></label>
                                    <div class="col-sm-10">
                                        <div class="w-z-docx">
                                            <div class="w-z-d-title">附件</div>
                                            <div class="w-z-d-list">
                                                <div align="center" class="row">
                                                    <div id="upload_atch_div"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row" id="upload_ar_div">
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label class="col-sm-2 control-label" for="">附件:</label>
                                    <div class="col-sm-10">
                                        <form class="form-horizontal" enctype="multipart/form-data"
                                              id="frm_transfer" method="post">
                                            <div id="fujianId"></div>
                                        </form>
                                        <div class="modal-footer">
                                            <button class="btn btn-primary-red" id="btn_save2"
                                                    onclick="javascript:addInputItem(1);"
                                                    type="button">
                                                <i class="glyphicon glyphicon-plus"></i>新增附件
                                            </button>
                                            <button class="btn btn-primary-red" id="btn_save1"
                                                    onclick="javascript:submitTransferFile(1);"
                                                    type="button">
                                                <i class="glyphicon glyphicon-upload"></i>上传
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>


                    </div>
                </fieldset>
            </form>
        </div>
        <div class="box-footer">
            <button class="btn btn-primary pull-right" id="btn_save"
                    onclick='javascript:validate_frm_detail();'
                    type="button">确定
            </button>
            <button class="btn btn-default pull-right" id="btn_close"
                    onclick='javascript:showOrHideDetail(true, 1);'
                    style="margin-right: 15px;"
                    type="button">取消
            </button>
        </div>
    </div>
</section>
<!-- 详细信息 end-->

<!-- 订单流转信息 start-->
<section class="content" id="ar_lnk_jrnl_inf_detail"
         style="display: none;">
    <div class="box box-info" id="ar_lnk_jrnl_inf_detail_clapse_box">
        <div class="box-header with-border">
            <h4 class="text-info" id="ar_lnk_jrnl_inf_detail_title">发货流转信息</h4>
            <div class="box-tools pull-right">
                <button class="btn btn-box-tool" data-widget="collapse">
                    <i class="fa fa-minus" id="ar_lnk_jrnl_inf_detail_li"></i>
                </button>
            </div>
        </div>
        <div class="box-body">
            <form class="form-horizontal" id="frm_detail3">
                <fieldset id='fld_detail3'>
                    <div class="w-z-info">
                        <!-- 环节流水信息列表 -->
                        <div class="row">
                            <div class="col-xs-12">
                                <div class="box box-info">
                                    <div class="box-body table-responsive no-padding">
                                        <div id="lnk_jrnl_inf_tbl_div"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </fieldset>
            </form>
        </div>
        <!-- 			<div class="box-footer">
        </div> -->
    </div>
</section>
<!-- 订单流转信息 end-->


</section>
<!-- 提交结论 start-->
<section id="submit_ar_detail" class="content" style="display: none;">
    <div class="box box-info">
        <div class="box-header with-border">
            <h4 id="submit_ar_detail_title" class="text-info">提交结论</h4>
            <div class="box-tools pull-right">
                <button class="btn btn-box-tool" data-widget="collapse">
                    <i class="fa fa-minus"></i>
                </button>
            </div>
        </div>
        <div class="box-body">
            <form id="frm_submit_ar" class="form-horizontal">
                <fieldset id='fld_detail'>
                    <div class="w-z-info">


                        <input type="hidden" id="fileId2" name="fileUrl2">
                        <input id="aplyPcstpCd" name="aplyPcstpCd" class="form-control" placeholder="" value=""
                               type="hidden"/>
                        <input name="ordrId" class="form-control" placeholder="" value="" type="hidden"/>
                        <input name="arId" class="form-control" placeholder="" value="" type="hidden"/>
                        <input id="pymtMod" name="pymtMod" class="form-control" placeholder="" value="" type="hidden"/>
                        <input name="spgId" class="form-control" placeholder="" value="" type="hidden"/>
                        <input id="selRdmgdsMod1" name="selRdmgdsMod1" class="form-control" placeholder="" value="" type="hidden"/>
                        <input class="form-control" id="aplyPsrlt" name="aplyPsrlt" placeholder="" type="hidden"
                               value=""/>



                        <!-- 接货承运信息 start-->
                        <input class="form-control" id="vhclNum" name="vhclNum" placeholder="车辆数目" type="hidden"
                               value=""/>
                        <input class="form-control" id="tprtModAndImt" name="tprtModAndImt" placeholder="运输方式及工具" type="hidden"
                               value=""/>
                        <input class="form-control" id="lgstcCo" name="lgstcCo" placeholder="物流公司" type="hidden"
                               value=""/>
                        <input class="form-control" id="revMnyPsn" name="revMnyPsn" placeholder="接货人" type="hidden"
                               value=""/>
                            <input class="form-control" id="revMnyCtcTel" name="revMnyCtcTel" placeholder="接货联系电话" type="hidden"
                               value=""/>
                        <input class="form-control" id="revMnyTm" name="revMnyTm" placeholder="接货时间" type="hidden"
                               value=""/>
                        <input class="form-control" id="revMnyRmrk" name="revMnyRmrk" placeholder="接货备注" type="hidden"
                               value=""/>
                        <!-- 接货承运信息 end-->

                        <!-- 接货入仓信息 start-->
                        <input class="form-control" id="stgco" name="stgco" placeholder="仓储公司" type="hidden"
                               value=""/>
                        <input class="form-control" id="intrsrPsn" name="intrsrPsn" placeholder="入库人" type="hidden"
                               value=""/>
                        <input class="form-control" id="intrsrTm" name="intrsrTm" placeholder="入库时间" type="hidden"
                               value=""/>
                        <input class="form-control" id="intrsrRmrk" name="intrsrRmrk" placeholder="入库备注" type="hidden"
                               value=""/>
                        <input class="form-control" id="outstgTm" name="outstgTm" placeholder="出库时间" type="hidden"
                               value=""/>
                        <input class="form-control" id="plgSt" name="plgSt" placeholder="质押状态" type="hidden"
                               value=""/>
                        <input class="form-control" id="strBit" name="strBit" placeholder="库位" type="hidden"
                               value=""/>
                        <input class="form-control" id="whrecptId" name="whrecptId" placeholder="仓单编号" type="hidden"
                               value=""/>
                        <input class="form-control" id="plgWarnStcd" name="plgWarnStcd" placeholder="质押预警状态代码" type="hidden"
                               value=""/>
                        <!-- 接货入仓信息 end-->




                        <div id="aplyPsrltInnerDiv">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="" class="col-sm-4 control-label">结论<span
                                                style="color: red">*</span></label>
                                        <div class="col-sm-8">
                                            <input type="radio" name="aplyPsrltCd" id="aplyPsrltCd01"
                                                   value="01" selected=""> 通过</input> &nbsp&nbsp&nbsp&nbsp<input
                                                type="radio" name="aplyPsrltCd" id="aplyPsrltCd02" value="02"
                                                selected=""> 退回</input>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div id="aplyPsrltDiv"></div>





                            <div class="row">
                                <div class="col-md-11" style="padding-right: 15px;">
                                    <div class="form-group" style="padding-left: 15px;">

                                        <label for="" class="col-sm-2 control-label">备注</label>
                                        <div class="col-md-10" style="padding-left: 10px;">
                                            <textarea name="rmrk" rows="4" class="form-control" margin>提交备注信息</textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row" id="submmit_ar_upload_ar_div">
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label for="" class="col-sm-2 control-label">附件</label>
                                    <div class="col-sm-10">
                                        <form id="frm_transfer" class="form-horizontal"
                                              enctype="multipart/form-data" method="post">
                                            <div id="fujianId2"></div>
                                        </form>
                                        <div class="modal-footer">
                                            <button id="btn_save2" type="button"
                                                    class="btn btn-primary-red"
                                                    onclick="javascript:addInputItem(2);">
                                                <i class="glyphicon glyphicon-plus"></i>新增附件
                                            </button>
                                            <button id="btn_save1" type="button"
                                                    class="btn btn-primary-red"
                                                    onclick="javascript:submitTransferFile(2);">
                                                <i class="glyphicon glyphicon-upload"></i>上传
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>



                        <!-- 库存明细 -->
                        <div class="col-md-12" style="padding-right: 15px; padding-top: 10px; " id="boot_table_div_kc">

                            <div class="col-md-12" style="padding-right: 15px;">
                                <!-- 订单明细部分 -->
                                <button type="button" class="btn btn-primary-gray btn-lg pull-right" data-toggle="modal"  onclick="showOrderDetailModal()"  style="margin-right:15px;">
                                    <i class="glyphicon glyphicon-th"></i>库存明细
                                </button>
                            </div>
                            <table id="boot-table-kc"  align="center" data-toggle="table" class="table table-hover" name="area" style="table-layout:fixed">
                                <thead>
                                <tr bgcolor="#337AB7">
										<th style="border-bottom: none;" data-field="ids">序号</th>										
										<th style="border-bottom: none;" data-field="pdNm">品名</th>
										<th style="border-bottom: none;" data-field="spec">规格</th>
										<th style="border-bottom: none;" data-field="modl">型号</th>
										<th style="border-bottom: none;" data-field="qlyStd">质量标准</th>
										<th style="border-bottom: none;" data-field="brnd">品牌</th>
										<th style="border-bottom: none;" data-field="pdFctr">生产厂家</th>
										<th style="border-bottom: none;" data-field="num">数量</th>
										<th style="border-bottom: none;" data-field="msunit">计量单位</th>
										<th style="border-bottom: none;" data-field="pdId">品名id</th>
                                    <th style="border-bottom: none;" data-field="operation" formatter="operateFormatter">操作</th>

                                </tr>
                                </thead>

                            </table>
                        </div>


                        <div class="box-footer">
                            <button id="btn_close" type="button"
                                    class="btn btn-primary-gray  pull-right"
                                    onclick='javascript:showOrHideDetail(true, 1);'
                                    style="margin-right: 15px;">
                                <i class="glyphicon glyphicon-remove-sign"></i>取消
                            </button>
                            <button id="btn_submit_ar" type="button"
                                    class="btn btn-primary-red  pull-right"
                                    onclick='javascript:validate_frm_submit_ar()'
                                    style="margin-right: 10px;">
                                <i class="glyphicon glyphicon-ok-sign"></i>确定
                            </button>
                        </div>
                    </div>
                </fieldset>
            </form>


        </div>
    </div>
</section>
<!-- 提交结论 end-->


<!-- 发货明细信息 -->
<!--<div class="modal fade" id="spgDetailModal" tabindex="-1" role="dialog" aria-labelledby="systemModalLabel"-->
     <!--aria-hidden="true">-->
    <!--<div class="modal-dialog" role="document" style="width: 800px;height:900px;">-->
        <!--<div class="modal-content">-->
            <!--<div class="modal-header">-->
                <!--<h5 class="modal-title">发货物明细</h5>-->
                <!--<button class="close" type="button" data-dismiss="modal" aria-label="Close"><span-->
                        <!--aria-hidden="true">×</span></button>-->
            <!--</div>-->
            <!--<div class="modal-body">-->
                <!--<div id="custom_data">-->

                    <!--<form id="frm_submit_ar222" class="form-horizontal">-->
                        <!--<input type="hidden" id=ordrId name="ordrId">-->
                        <!--<div class="col-md-6">-->
                            <!--<div class="form-group">-->
                                <!--<label for="" class="col-sm-4 control-label">品名<span-->
                                        <!--style="color: red">*</span></label>-->
                                <!--<div class="col-sm-8">-->
                                    <!--<input name="pdNm" id="pdNm" class="form-control" placeholder="品名" value="223"/>-->
                                <!--</div>-->
                            <!--</div>-->
                        <!--</div>-->
                        <!--<div class="col-md-6">-->
                            <!--<div class="form-group">-->
                                <!--<label for="" class="col-sm-4 control-label">规格<span-->
                                        <!--style="color: red">*</span></label>-->
                                <!--<div class="col-sm-8">-->
                                    <!--<input name="spec" id="spec" class="form-control" placeholder="规格" value="223"/>-->
                                <!--</div>-->
                            <!--</div>-->
                        <!--</div>-->

                        <!--<div class="col-md-6">-->
                            <!--<div class="form-group">-->
                                <!--<label for="" class="col-sm-4 control-label">质量标准<span-->
                                        <!--style="color: red">*</span></label>-->
                                <!--<div class="col-sm-8">-->
                                    <!--<input name="qlyStd" id="qlyStd" class="form-control" placeholder="质量标准"-->
                                           <!--value="223"/>-->
                                <!--</div>-->
                            <!--</div>-->
                        <!--</div>-->
                        <!--<div class="col-md-6">-->
                            <!--<div class="form-group">-->
                                <!--<label for="" class="col-sm-4 control-label">品牌</label>-->
                                <!--<div class="col-sm-8">-->
                                    <!--<input name="brnd" id="brnd" class="form-control" placeholder="品牌" value="223"/>-->
                                <!--</div>-->
                            <!--</div>-->
                        <!--</div>-->
                        <!--<div class="col-md-6">-->
                            <!--<div class="form-group">-->
                                <!--<label for="" class="col-sm-4 control-label">生产厂家</label>-->
                                <!--<div class="col-sm-8">-->
                                    <!--<input name="pdFctr" id="pdFctr" class="form-control" placeholder="生产厂家"-->
                                           <!--value="223"/>-->
                                <!--</div>-->
                            <!--</div>-->
                        <!--</div>-->
                        <!--<div class="col-md-6" id="wght_div">-->
                            <!--<div class="form-group">-->
                                <!--<label for="" class="col-sm-4 control-label">数量<span-->
                                        <!--style="color: red">*</span></label>-->
                                <!--<div class="col-sm-8">-->
                                    <!--<div class="col-xs-5" style="padding-left: 0px;">-->
                                        <!--<input name="num" id="num" class="form-control" placeholder="数量"-->
                                               <!--value="4"/>-->
                                    <!--</div>-->

                                    <!--<div class="col-xs-2">-->
                                        <!--<label for="" class="control-label"></label>-->
                                    <!--</div>-->

                                    <!--<div class="col-xs-5">-->
                                        <!--<select name="msunit" id="msunit" class="form-control">-->
                                            <!--<option value="">-计量单位-</option>-->
                                            <!--<option value="01" selected="selected">吨</option>-->
                                            <!--<option value="02">件</option>-->
                                            <!--<option value="03">公斤</option>-->
                                            <!--<option value="04">方</option>-->
                                            <!--<option value="05">个</option>-->
                                        <!--</select>-->
                                    <!--</div>-->
                                <!--</div>-->
                            <!--</div>-->
                        <!--</div>-->

                    <!--</form>-->

                <!--</div>-->
            <!--</div>-->
            <!--<div class="modal-footer" style="text-align:center;">-->
                <!--<a class="btn btn-primary-red" type="button" id="add" onclick=addSpgDetail()><i-->
                        <!--class="glyphicon glyphicon-plus"></i>&nbsp添 加</a>-->
            <!--</div>-->
        <!--</div>-->
    <!--</div>-->
<!--</div>-->
<!-- 发货明细信息 -->

<!-- 查看界面的返回按钮 end-->
<!-- 查看界面的返回按钮 start-->
<div id="btn_close_div"
     style="z-index: 9999; position: fixed ! important; right: 80px; top: 25px; display: none; opacity: 0.65">
    <table 100%
           style="position: absolute; width: 260px; right: 0px; top: 0px;" width="">
        <button class="btn btn-success pull-right btn-lg" id="btn_close_detail"
                onclick='javascript:showOrHideDetail(true, 1);'
                style="margin-right: 15px;"
                type="button">
            <i class="glyphicon glyphicon-arrow-left"></i> 返 回
        </button>
    </table>
</div>
<!-- 查看界面的返回按钮 end-->

<!-- 查询订单提交详细信息 start-->
<section id="query_ar_submmit_detail" style="display: none;">
    <div class="box box-info">
        <div class="box-header with-border">
            <h4 id="query_ar_submmit_title" class="text-info">订单提交详情</h4>
            <div class="box-tools pull-right">
                <button class="btn btn-box-tool" data-widget="collapse">
                    <i class="fa fa-minus"></i>
                </button>
            </div>
        </div>
        <div class="box-body">
            <form id="frm_detail2" class="form-horizontal">
                <div class="w-z-info">
                    <fieldset id='fld_detail_query_order_submmit'>
                        <div id="query_order_submmit_div"></div>

                        <div class="row" id="query_ar_atch_div2">
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label for="" class="col-sm-2 control-label"></label>
                                    <div class="col-sm-10">
                                        <div class="w-z-docx">
                                            <div class="w-z-d-title">附件</div>
                                            <div class="w-z-d-list">
                                                <div class="row" align="center">
                                                    <div id="upload_atch_div2"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </fieldset>
                </div>
            </form>
        </div>
        <!-- 			<div class="box-footer">
                        <button id="btn_close_return3" type="button"
                            class="btn btn-primary-gray pull-right"
                            onclick='javascript:showOrHideDetail(false, 3);'
                            style="margin-right: 15px;">
                            <i class="glyphicon glyphicon-repeat"></i>返回
                        </button>
                        <button id="btn_close_return4" type="button"
                            class="btn btn-primary-gray pull-right"
                            onclick='javascript:showOrHideDetail(false, 4);'
                            style="margin-right: 15px;">
                            <i class="glyphicon glyphicon-repeat"></i>返回
                        </button>
                    </div> -->
    </div>
</section>
<!-- 查询订单提交详细信息 end-->

<!-- 发起确认提示框 start-->
<div aria-hidden="true" aria-labelledby="submitModalLabel" class="modal fade"
     id="saveSubmitModal" role="dialog" tabindex="-1">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div align="center" class="modal-header">
                <h4 class="modal-title">友情提示</h4>
                <button aria-label="Close" class="close" data-dismiss="modal"
                        type="button">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div align="center" class="modal-body">提交后将自动流转到[供应链确认]，若需修改需要下一环节退回，确定提交吗?</div>
            <div align="center" class="modal-footer">
                <button class="btn" data-dismiss="modal" onclick="javascript:save()"
                        type="button">确定
                </button>
                <button class="btn" data-dismiss="modal" type="button">取消</button>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div>
<!-- 发起确认提示框 end -->
<!-- 订单提交确认提示框 start -->
<div aria-hidden="true" aria-labelledby="submitModalLabel" class="modal fade" id="submitArModal"
     role="dialog" tabindex="-1">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div align="center" class="modal-header">
                <h4 class="modal-title">友情提示</h4>
                <button aria-label="Close" class="close" data-dismiss="modal"
                        type="button">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div align="center" class="modal-body" id="saveSubmitModalTips">提交后将自动流转到下一环节，若需修改需要下一环节退回，确定提交吗?</div>
            <div align="center" class="modal-footer">
                <button class="btn btn-primary-red" data-dismiss="modal"
                        onclick="javascript:submitSpg()" type="button">
                    <i class="glyphicon glyphicon-ok-sign"></i>确定
                </button>
                <button class="btn btn-primary-gray" data-dismiss="modal"
                        type="button">
                    <i class="glyphicon glyphicon-remove-sign"></i>取消
                </button>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div>
<!-- 订单提交确认提示框 end -->

<!-- 发货撤销确认提示框 start -->
	<div class="modal fade" id="arUndoModal" tabindex="-1" role="dialog"
		aria-labelledby="submitModalLabel" aria-hidden="true">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header" align="center">
					<h4 class="text-info">提示：请填写撤销原因并提交 或 取消</h4>
					<button type="button" class="close" data-dismiss="modal"
						aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
				</div>
				<div class="modal-body" align="center"></div>				
				<div class="container-fluid text-center">
					<div class="form-group" >
						<textarea name="epap" rows="3" class="form-control" placeholder="请填写撤销原因"></textarea>
					</div>
				</div>								
				<div class="modal-footer" align="center">
					<button type="button" onclick="javascript:spgUndo()"
						class="btn btn-primary-red" data-dismiss="modal">
						<i class="glyphicon glyphicon-ok-sign"></i>确定
					</button>
					<button type="button" class="btn btn-primary-gray"
						data-dismiss="modal">
						<i class="glyphicon glyphicon-remove-sign"></i>取消
					</button>
				</div>
			</div>
			<!-- /.modal-content -->
		</div>
		<!-- /.modal-dialog -->
	</div>
<!-- 发货撤销确认提示框 end -->


<!-- 审核提交界面的返回按钮 start-->
<div id="submmit_btn_close_div"
     style="z-index: 9999; position: fixed ! important; right: 80px; top: 25px; display: none; opacity:0.65">
    <table width="" 100% style="position: absolute; width:260px; right: 0px; top: 0px;">
        <button id="btn_close_return3" type="button"
                class="btn btn-success pull-right btn-lg"
                onclick='javascript:showOrHideDetail(true, 3);'
                style="margin-right: 15px;">
            <i class="glyphicon glyphicon-arrow-left"></i> 返 回
        </button>
        <button id="btn_close_return4" type="button"
                class="btn btn-success pull-right btn-lg"
                onclick='javascript:showOrHideDetail(true, 4);'
                style="margin-right: 15px;">
            <i class="glyphicon glyphicon-arrow-left"></i> 返 回
        </button>
    </table>
</div>

<!-- 审核提交界面的返回按钮 end-->



<!-- 发货明细信息 -->
<div class="modal fade" id="orderDetailModal" tabindex="-1" role="dialog" aria-labelledby="systemModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document" style="width: 800px;height:900px;">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">货物明细</h5>
                <button class="close" type="button"  data-dismiss="modal" aria-label="Close"><span
                        aria-hidden="true">×</span></button>
            </div>
            <div class="modal-body">
                <div id="custom_data">

                  <form id="frm_submit_ar222" class="form-horizontal">
							<input type="hidden" id=ordrId name="ordrId">

							<div class="col-md-6" style="display:none">
								<div class="form-group">
									<label for="" class="col-sm-4 control-label">序号<span
											style="color: red">*</span></label>
									<div class="col-sm-8">
										<input name="ids" id="ids" class="form-control" placeholder="序号" value="" />
									</div>
								</div>
							</div>

							<div class="col-md-6" >
								<div class="form-group">
									<label for="" class="col-sm-4 control-label">品名<span
											style="color: red">*</span></label>
									<div class="col-sm-8">
										<select name="pdNm" id="pdNm" class="form-control" onchange="setPdInf()">
											<option value="">请选择</option>
											<option th:each="model: ${pmModels}"
												th:value="${model.id}" th:text="${model.name}"></option>
										</select>
									</div>
								</div>
							</div>
							<div class="col-md-6" >
								<div class="form-group">
									<label for="" class="col-sm-4 control-label">规格<span
										style="color: red">*</span></label>
									<div class="col-sm-8">
										<input name="spec" id="spec" class="form-control" placeholder="规格" disabled="disabled" />
									</div>
								</div>
							</div>
							<div class="col-md-6" >
								<div class="form-group">
									<label for="" class="col-sm-4 control-label">型号</label>
									<div class="col-sm-8">
										<input name="modl" id="modl" class="form-control" placeholder="型号" disabled="disabled" />
									</div>
								</div>
							</div>

							<div class="col-md-6" >
								<div class="form-group">
									<label for="" class="col-sm-4 control-label">质量标准<span
											style="color: red">*</span></label>
									<div class="col-sm-8">
										<input name="qlyStd" id="qlyStd" class="form-control" placeholder="质量标准" disabled="disabled"  />
									</div>
								</div>
							</div>
							<div class="col-md-6" >
								<div class="form-group">
									<label for="" class="col-sm-4 control-label">品牌</label>
									<div class="col-sm-8">
										<input name="brnd" id="brnd" class="form-control" placeholder="品牌" disabled="disabled" />
									</div>
								</div>
							</div>
							<div class="col-md-6" >
								<div class="form-group">
									<label for="" class="col-sm-4 control-label">生产厂家</label>
									<div class="col-sm-8">
										<input name="pdFctr" id="pdFctr" class="form-control" placeholder="生产厂家" disabled="disabled"  />
									</div>
								</div>
							</div>
							<div class="col-md-6" id="wght_div">
								<div class="form-group">
									<label for="" class="col-sm-4 control-label">数量<span
											style="color: red">*</span></label>
									<div class="col-sm-8">
										<div class="col-xs-5" style="padding-left: 0px;">
											<input name="num" id="num" class="form-control" placeholder="数量"/>
										</div>

										<div class="col-xs-2">
											<label for="" class="control-label"></label>
										</div>

										<div class="col-xs-5">
											<input name="msunit" id="msunit"  class="form-control" placeholder="计量单位" disabled="disabled"/>
										</div>
									</div>
								</div>
							</div>

						</form>

                </div>
            </div>
            <div class="modal-footer" style="text-align:center;">

                <a class="btn btn-primary-red"  type="button"  id="btn_add_order_detail" onclick=addOrderDetail()><i class="glyphicon glyphicon-plus"></i>&nbsp添 加</a>
                <a class="btn btn-primary-red"  type="button"  id="btn_modify_order_detail" onclick=addOrderDetail()><i class="glyphicon glyphicon-edit"></i>&nbsp更新</a>
                <button type="button" class="btn btn-primary-gray"
                        data-dismiss="modal">
                    <i class="glyphicon glyphicon-remove-sign"></i>取消
                </button>
            </div>
        </div>
    </div>
</div>
<!-- /.content -->
<script th:src="@{/resources/plugins/jQuery/jquery-2.2.3.min.js}"></script>
<script th:src="@{/resources/plugins/bootbox/bootbox.min.js?v=1}"></script>
<script th:src="@{/resources/bootstrap/js/bootstrap.min.js}"></script>
<script
        th:src="@{/resources/plugins/bootstrapValidator/bootstrapValidator.min.js}"></script>
<script th:src="@{/resources/dist/js/app.min.js}"></script>
<script th:src="@{/resources/e7/e7util-0.2.js}"></script>
<script th:src="@{/resources/e7/e7table/e7table-0.2.js}"></script>
<script th:src="@{/resources/e7/e7crud-0.2.js}"></script>
<script th:src="@{/resources/adminlte/plugins/ckeditor/ckeditor.js}"></script>
<script
        th:src="@{/resources/plugins/datetimepicker/js/bootstrap-datetimepicker.min.js}"></script>
<script
        th:src="@{/resources/plugins/datetimepicker/js/locales/bootstrap-datetimepicker.zh-CN.js}"></script>
<script th:src="@{/resources/js_zcb/tools.js}"></script>
<script th:src="@{/resources/js_zcb/common.js}"></script>
<script th:src="@{/resources/bootstrap/js/bootstrap-table.min.js}"></script>
<script type="text/javascript">


    function showOrderDetailModal() {
		$('#ids').val("");
		$('#pdNm').val("");
		$('#spec').val("");
		$('#modl').val("");
		$('#qlyStd').val("");
		$('#pdFctr').val("");
		$('#msunit').val("");
		$('#num').val("");
		$('#brnd').val("");
		$('#pdId').val("");	
        // 按钮控制
        $('#btn_modify_order_detail').hide();
        $('#btn_add_order_detail').show();
        $('#orderDetailModal').modal('show');
    }

    /* 日期选择控件-订单开始日期 */
    $('#arStdtDTPicker').datetimepicker({
        language: 'zh-CN',
        minView: "month",//设置只显示到月份
        format: "yyyy-mm-dd",//日期格式
        autoclose: true,//选中关闭
        todayBtn: true
        //今日按钮
    }).on(
        'changeDate',
        function (ev) {
            $('#arEddtDTPicker')
                .datetimepicker('setStartDate', ev.date);
            var oneYearAfter = ev.date;
            oneYearAfter.setFullYear(oneYearAfter.getFullYear() + 1);
            oneYearAfter.setDate(oneYearAfter.getDate() - 1);
            $('#arEddtDTPicker')
                .datetimepicker('setDate', oneYearAfter);

            $('#frm_detail').data('bootstrapValidator').updateStatus(
                'arStdt', 'NOT_VALIDATED', null).validateField(
                'arStdt');
            $('#frm_detail').data('bootstrapValidator').updateStatus(
                'arEddt', 'NOT_VALIDATED', null).validateField(
                'arEddt');
            // 判断保险起止时间与订单起止时间，并提示，但是不禁止提交
            checkInsDtAndArDt();
        });
    /* 日期选择控件-订单结束日期 */
    $('#arEddtDTPicker').datetimepicker({
        language: 'zh-CN',
        minView: "month",//设置只显示到月份
        format: "yyyy-mm-dd",//日期格式
        autoclose: true,//选中关闭
        todayBtn: true
        //今日按钮
    }).on(
        'changeDate',
        function (ev) {
            $('#frm_detail').data('bootstrapValidator').updateStatus(
                'arStdt', 'NOT_VALIDATED', null).validateField(
                'arStdt');
            $('#frm_detail').data('bootstrapValidator').updateStatus(
                'arEddt', 'NOT_VALIDATED', null).validateField(
                'arEddt');
            // 判断保险起止时间与订单起止时间，并提示，但是不禁止提交
            checkInsDtAndArDt();
        });
    /* 日期选择控件 - 保险开始日期*/
    $('#insStdtDTPicker').datetimepicker({
        language: 'zh-CN',
        minView: "month",//设置只显示到月份
        format: "yyyy-mm-dd",//日期格式
        autoclose: true,//选中关闭
        todayBtn: true
        //今日按钮
    }).on(
        'changeDate',
        function (ev) {
            $('#insEddtDTPicker').datetimepicker('setStartDate',
                ev.date);
            var oneYearAfter = ev.date;
            oneYearAfter.setFullYear(oneYearAfter.getFullYear() + 1);
            oneYearAfter.setDate(oneYearAfter.getDate() - 1);

            $('#insEddtDTPicker').datetimepicker('setDate',
                oneYearAfter);
            $('#frm_detail').data('bootstrapValidator').updateStatus(
                'insStdt', 'NOT_VALIDATED', null).validateField(
                'insStdt');
            $('#frm_detail').data('bootstrapValidator').updateStatus(
                'insEddt', 'NOT_VALIDATED', null).validateField(
                'insEddt');
            // 判断保险起止时间与订单起止时间，并提示，但是不禁止提交
            checkInsDtAndArDt();
        });
    /* 日期选择控件 - 保险结束日期*/
    $('#insEddtDTPicker').datetimepicker({
        language: 'zh-CN',
        minView: "month",//设置只显示到月份
        format: "yyyy-mm-dd",//日期格式
        autoclose: true,//选中关闭
        todayBtn: true
        //今日按钮
    }).on(
        'changeDate',
        function (ev) {
            $('#frm_detail').data('bootstrapValidator').updateStatus(
                'insStdt', 'NOT_VALIDATED', null).validateField(
                'insStdt');
            $('#frm_detail').data('bootstrapValidator').updateStatus(
                'insEddt', 'NOT_VALIDATED', null).validateField(
                'insEddt');
            // 判断保险起止时间与订单起止时间，并提示，但是不禁止提交
            checkInsDtAndArDt();
        });

    // 判断保险起止时间与订单起止时间，并提示，但是不禁止提交
    function checkInsDtAndArDt() {
        var msg = "";
        if (($('#insStdtDTPicker').val() != "")
            && ($('#arStdtDTPicker').val() != "")
            && ($('#insStdtDTPicker').val() > $('#arStdtDTPicker')
                .val())) {
            msg += "[保险开始日期] 晚于 [订单开始日期] !";
        }
        if (($('#insEddtDTPicker').val() != "")
            && ($('#arEddtDTPicker').val() != "")
            && ($('#insEddtDTPicker').val() < $('#arEddtDTPicker')
                .val())) {
            msg += "[保险结束日期] 早于 [订单结束日期] !";
        }
        if (msg != "") {
            bootbox.alert({
                'title': '特别提醒',
                'message': msg
            });
        }
    }

    var pageSetting = {
        modelName: '订单信息管理',
        resetPath: '[[@{/spgManagement}]]'
    };
    
    var pdObj;
    $(function () {
		// 品名信息
		var test ='[[${pmModels}]]';
		if(test != null && test !=undefined){
			test1=test.replace(/&quot;/g,"\"");
			pdObj =  JSON.parse(test1);	
		}
        //e7table表格控件初始化
        e7tableInit();
        //表单校验控件初始化
        validator_1_Init();
        validator_2_Init();
        buttonInit();
        // 是否投保默认不选中，用户自己选择
        //			$("input:radio[name="isNeedIns"]").attr("checked",false);
        CKEDITOR.replace("editor1")

    });

	// 订单明细中品名信息各项获取
		function setPdInf(){
			var pdId = $('#pdNm').val();
		for(var i=0;i<pdObj.length;i++){
			if(pdObj[i].id == pdId){

				// 计量单位
				$('#msunit').val(pdObj[i].msunit);
				// 质量标准
				$('#qlyStd').val(pdObj[i].qlyStd);
				// 规格
				$('#spec').val(pdObj[i].spec);
				// 品牌
				$('#brnd').val(pdObj[i].brnd);
				// 生产厂家
				$('#pdFctr').val(pdObj[i].pdFctr);
				// 型号
				$('#modl').val(pdObj[i].modl);
			}
		}			
		}
	
    /***
     * 添加订单明细到页面表格
     */
    function addSpgDetail() {


        var rows = [];
        rows.push({
            pdNm: $('#pdNm').val(),
            spec: $('#spec').val(),
            qlyStd: $('#qlyStd').val(),
            brnd: $('#brnd').val(),
            pdFctr: $('#pdFctr').val(),
            num: $('#num').val(),


        })
        $('#boot-table-spgDetail').bootstrapTable('append', rows);
//        $('#boot-table').bootstrapTable('hideColumn', 'pdNm');
        $("#boot_table_div_spg").fadeIn(800);
        $("#spgDetailModal").modal("hide");
    }

    /***
     * 查询
     */
    function query_ar_list() {
        showOrHideDetail(true, 1);
        $('#tbl_query').e7table('query', '#frm_query');

    }

    function showOrHideDetail(editable, flag) {
        if (editable) {
            $('#fld_detail').prop('disabled', false);
            $('#btn_save').show();
        } else {
            $('#fld_detail').prop('disabled', true);
            $('#btn_save').hide();
        }
        // 订单列表查询
        if (flag == 1) {
            $('#main_search_detail').fadeIn(800);
            $('#main_edit_detail').hide();
            $('#ar_lnk_jrnl_inf_detail').hide();
            $('#submit_ar_detail').hide();
            // 返回按钮
            $('#btn_close_div').hide();
            $('#query_ar_submmit_detail').hide();
        } else if (flag == 2) {// 订单发起
            // section
            $('#main_edit_detail_title').text("订单发起");
            $('#main_edit_detail').fadeIn(800);
            $('#main_search_detail').hide();
            $('#ar_lnk_jrnl_inf_detail').hide();
            $('#submit_ar_detail').hide();
            $('#query_ar_submmit_detail').hide();
            // 返回按钮
            $('#btn_close_div').hide();
            // 附件
            $('#upload_ar_div').show();
            $('#query_ar_atch_div').hide();
            // 保险信息输入部门默认隐藏
            show_or_hide_ins_div(false);
            // 参数
            $('#arIdDiv').hide();
            // 按钮
            $('#btn_close').show();
            $('#btn_save').show();
            //面板收缩控制
            var div = document.getElementById('main_edit_detail_clapse');
            div.setAttribute("class", "box box-info");
            //面板收缩+-号
            div = document.getElementById('main_edit_detail_li');
            div.setAttribute("class", "fa fa-minus");
        } else if (flag == 3) {// 订单详情查看
            //$('#main_edit_detail_title').text("订单信息");
            // section
            // 保险信息输入部门显示隐藏
            show_or_hide_ins_div(true);
            $('#main_edit_detail').fadeIn(800);
            $('#main_search_detail').hide();
            $('#ar_lnk_jrnl_inf_detail').fadeIn(800);
            $('#submit_ar_detail').hide();
            $('#query_ar_submmit_detail').hide();
            // 附件
            $('#upload_ar_div').hide();
            //				$('#query_ar_atch_div').show();//改为在查询后控制显示，没有数据的不显示
            // 返回按钮
            $('#btn_close_div').show();
            // 参数
            $('#arIdDiv').show();
            // 按钮
            $('#btn_close').hide();
            $('#btn_save').hide();
            //面板收缩控制
            var div = document
                .getElementById('ar_lnk_jrnl_inf_detail_clapse_box');
            div.setAttribute("class", "box box-info");
            div = document.getElementById('main_edit_detail_clapse');
            div.setAttribute("class", "box box-info");
            //面板收缩+-号
            div = document.getElementById('main_edit_detail_li');
            div.setAttribute("class", "fa fa-minus");
        } else if (flag == 6) {// 订单修改
            // section
            $('#main_edit_detail_title').text("订单修改");
            $('#main_edit_detail').fadeIn(800);
            $('#main_search_detail').hide();
            $('#ar_lnk_jrnl_inf_detail').hide();
            $('#submit_ar_detail').hide();
            $('#query_ar_submmit_detail').hide();
            // 返回按钮
            $('#btn_close_div').hide();
            // 附件
            $('#upload_ar_div').show();
            $('#query_ar_atch_div').hide();
            // 保险信息输入部门默认隐藏
            show_or_hide_ins_div(true);
            // 参数
            $('#arIdDiv').hide();
            // 按钮
            $('#btn_close').show();
            $('#btn_save').show();
            //面板收缩控制
            var div = document.getElementById('main_edit_detail_clapse');
            div.setAttribute("class", "box box-info");
            //面板收缩+-号
            div = document.getElementById('main_edit_detail_li');
            div.setAttribute("class", "fa fa-minus");
        } else if (flag == 4) {// 订单提交
            //$('#main_edit_detail_title').text("订单信息");
            // section
            $('#main_edit_detail').fadeIn(800);
            $('#main_search_detail').hide();
            $('#ar_lnk_jrnl_inf_detail').fadeIn(800);
            $('#submit_ar_detail').fadeIn(800);
            $('#query_ar_submmit_detail').hide();
            // 附件
            $('#upload_ar_div').hide();
            $('#query_ar_atch_div').show();
            // 返回按钮
            $('#btn_close_div').show();
            // 参数
            $('#arIdDiv').show();
            // 按钮
            $('#btn_close').hide();
            $('#btn_save').hide();
            //面板收缩控制
            var div = document
                .getElementById('ar_lnk_jrnl_inf_detail_clapse_box');
            div.setAttribute("class", "box box-info collapsed-box");
            div = document.getElementById('main_edit_detail_clapse');
            div.setAttribute("class", "box box-info collapsed-box");
            //面板收缩+-号
            div = document.getElementById('main_edit_detail_li');
            div.setAttribute("class", "fa fa-plus");
            div = document.getElementById('ar_lnk_jrnl_inf_detail_li');
            div.setAttribute("class", "fa fa-plus");
        } else if (flag == 5) {//订单提交详情查看
            $('#main_search_detail').hide();
            $('#main_edit_detail').hide();
            $('#ar_lnk_jrnl_inf_detail').hide();
            $('#submit_ar_detail').hide();
            // 返回按钮
            // $('#btn_close_div').show();
            $('#submmit_btn_close_div').show();
            $('#query_ar_submmit_detail').fadeIn(800);
        }
    }

    /***
     * 重置
     */
    function reset() {
        E7.resetForm('#frm_query');
    }


    //提交审批前的校验
    function validate_frm_submit_ar() {
        $('#frm_submit_ar').bootstrapValidator('validate');
        if (!$('#frm_submit_ar').data('bootstrapValidator').isValid()) {
            return;
        } else {
            var nestStepName = "";
            var aplyPsrltCd = "";
            var aplyPsrltCdRadio = document
                .getElementsByName("aplyPsrltCd");
            var pymtmod = $('#pymtmod').val();
            for (var i = 0; i < aplyPsrltCdRadio.length; i++) {
                if (aplyPsrltCdRadio[i].checked)
                    aplyPsrltCd = aplyPsrltCdRadio[i].value;
            }

			// 设置单选钮的选中状态，为了查询时展示正确状态
			  if("01" == aplyPsrltCd){
				  $('#aplyPsrltCd02').attr("checked",false); 
				  $('#aplyPsrltCd01').attr("checked",true);
			    } else if("02" == aplyPsrltCd){
					  $('#aplyPsrltCd02').attr("checked",true); 
					  $('#aplyPsrltCd01').attr("checked",false);
		    	}
			
            if ("01" == aplyPsrltCd) {
                nestStepName = getNextStepNameOfOrder($('#aplyPcstpCd')
                    .val(), 1, $('#pymtmod').val(),$('#selRdmgdsMod1').val());
                if (null == nestStepName || "" == nestStepName)
                    nestStepName = "下一环节";
                $('#saveSubmitModalTips').text(
                    "提交后将流转到 [ " + nestStepName + " ] ，确定提交吗?");
            } else if ("02" == aplyPsrltCd) {
                nestStepName = getNextStepNameOfOrder($('#aplyPcstpCd')
                    .val(), 2, $('#pymtmod').val(),$('#selRdmgdsMod1').val());
                $('#saveSubmitModalTips').text(
                    "提交后将退回到 [ " + nestStepName + " ] ，确定提交吗?");
            }

            // 个性化审批界面html内容
            //清除校验格式
            $('#frm_submit_ar').data('bootstrapValidator').resetForm();
            $('#aplyPsrlt').val(document.getElementById('aplyPsrltInnerDiv').innerHTML);





            $('#submitArModal').modal('show');
        }
    }

    function getNextStepNameOfOrder(currStep, flag, pymtmod, selRdmgdsMod) {




            var a = "";
            var selRdmgdsModRadio = document
                .getElementsByName("selRdmgdsMod");
            var pymtmod = $('#pymtmod').val();
            for (var i = 0; i < selRdmgdsModRadio.length; i++) {
                if (selRdmgdsModRadio[i].checked)
                    a = selRdmgdsModRadio[i].value;
            }



        if(""!=a) {
            selRdmgdsMod=a;

        }


        // currStep,当前环节；flag，跳转方向1通过，2退回
        var nextStepName = "";
        if ("01" == currStep) {
            if (1 == flag)
                nextStepName = "长约确认(供应链)";
            else if (2 == flag)
                nextStepName = "";
        } else if ("02" == currStep) {
            if (1 == flag)
                nextStepName = "长约确认(融资企业)";
            else if (2 == flag)
                nextStepName = "长约发起（平台）";
        } else if ("03" == currStep) {
            if (1 == flag)
                nextStepName = "确认承保（保险公司）";
            else if (2 == flag)
                nextStepName = "长约确认(供应链)";
        } else if ("04" == currStep) {
            if (1 == flag)
                nextStepName = "长约一审（平台）";
            else if (2 == flag)
                nextStepName = "长约确认(融资企业)";
        } else if ("05" == currStep) {
            if (1 == flag)
                nextStepName = "长约二审（平台）";
            else if (2 == flag)
                nextStepName = "确认承保（保险公司）";
        } else if ("06" == currStep) {
            if (1 == flag)
                nextStepName = "长约终止（平台）";
            else if (2 == flag)
                nextStepName = "长约一审（平台）";
        } else if ("07" == currStep) {
            if (1 == flag)
                nextStepName = "长约结束";
            else if (2 == flag)
                nextStepName = "长约二审（平台）";
        } else if ("31" == currStep) {
            if (1 == flag)
                nextStepName = "订单审核(平台)";
            else if (2 == flag)
                nextStepName = "";
        } else if ("32" == currStep) {
            if (1 == flag)
                nextStepName = "保证金支付(融资企业)";
            else if (2 == flag)
                nextStepName = "订单发起(供应链)";
        } else if ("33" == currStep) {
            if (1 == flag)
                nextStepName = "融资发放(银行)";
            else if (2 == flag)
                nextStepName = "订单审核(平台)";
        } else if ("34" == currStep) {
            if (1 == flag)
                nextStepName = "货款支付(融资企业)";
            else if (2 == flag)
                nextStepName = "保证金支付(融资企业)";
        } else if ("35" == currStep) {
            if (1 == flag) {
                if ("01" == pymtmod)
                    nextStepName = "货款支付(供应链)";
                else if (("02" == pymtmod) || ("03" == pymtmod))
                    nextStepName = "确认收款(供应链)";
            } else if (2 == flag)
                nextStepName = "融资发放(银行)";
        } else if ("36" == currStep) {
            if (1 == flag)
                nextStepName = "确认承保(保险公司)";
            else if (2 == flag)
                nextStepName = "货款支付(融资企业)";
        } else if ("37" == currStep) {
            if (1 == flag) {
                if ("02" == pymtmod)
                    nextStepName = "确认承保(保险公司)";
                else if ("03" == pymtmod)
                    nextStepName = "订单终止(供应链)";
            } else if (2 == flag)
                nextStepName = "货款支付(供应链)";
        } else if ("38" == currStep) {
            if (1 == flag)
                nextStepName = "订单终止(供应链)";
            else if (2 == flag) {
                if ("01" == pymtmod)
                    nextStepName = "货款支付(供应链)";
                else if ("02" == pymtmod)
                    nextStepName = "确认收款(供应链)";
            }
        } else if ("39" == currStep) {
            if (1 == flag)
                nextStepName = "订单完结";
            else if (2 == flag) {
                if ("01" == pymtmod || "02" == pymtmod)
                    nextStepName = "确认承保(保险公司)";
                else if ("03" == pymtmod)
                    nextStepName = "确认收款(供应链)";
            }
        } else if ("61" == currStep) {//61-发货发起(上游)
            if (1 == flag) {

                if ("01" == pymtmod || "02" == pymtmod) {


                    nextStepName = "62-接货承运(物流)";
                } else if ("03" == pymtmod) {
                    nextStepName = "63-接货入库(仓储)";

                }


            } else if (2 == flag) {

                nextStepName = "订单终止(供应链)";
            }

        } else if ("62" == currStep) {//62-接货承运(物流)
            if (1 == flag) {

                if ("01" == pymtmod) {

                    nextStepName = "63-接货入库(仓储)";

                } else if ("02" == pymtmod) {

                    nextStepName = "64-货款支付(供应链)";
                }


            } else if (2 == flag) {

                if ("01" == pymtmod || "02" == pymtmod) {

                    nextStepName = "发货发起(上游)";

                }
            }


        } else if ("63" == currStep) {//63-接货入库(仓储)
            if (1 == flag) {


                if ("01" == pymtmod) {

                    nextStepName = "65-选择赎货方式(供应链)";

                } else if ("02" == pymtmod) {

                    nextStepName = "65-选择赎货方式(供应链)";
                } else if ("03" == pymtmod) {

                    nextStepName = "66-选择赎货方式并支付(供应链)";
                }


            } else if (2 == flag) {


                if ("01" == pymtmod) {

                    nextStepName = "62-接货承运(物流)";

                } else if ("02" == pymtmod) {

                    nextStepName = "65-选择赎货方式(供应链)";
                }
                if ("03" == pymtmod) {

                    nextStepName = "61-发货发起(上游)";

                }


            }

        } else if ("64" == currStep) {    //64-货款支付(供应链)

            if (1 == flag) {

                if ("02" == pymtmod) {

                    nextStepName = "63-接货入库(仓储)";
                }

            } else if (2 == flag) {


                if ("02" == pymtmod) {

                    nextStepName = "62-接货承运(物流)";
                }

            }

        } else if ("65" == currStep) {//65-选择赎货方式(供应链)
            if (1 == flag) {


                if ("01" == selRdmgdsMod) {

                    nextStepName = "67-回款赎货(融资企业)";
                } else if ("02" == selRdmgdsMod) {

                    nextStepName = "68-质押置换(供应链)";
                }
            } else if (2 == flag)
                nextStepName = "63-接货入库(仓储)";
        } else if ("66" == currStep) {//66-选择赎货方式并支付(供应链)
            if (1 == flag) {
                if ("01" == selRdmgdsMod) {

                    nextStepName = "67-回款赎货(融资企业)";
                } else if ("02" == selRdmgdsMod) {

                    nextStepName = "68-质押置换(供应链)";
                }
            } else if (2 == flag)
                nextStepName = "63-接货入库(仓储)";
        } else if ("67" == currStep) {//67-回款赎货(融资企业)
            if (1 == flag) {
                if ("01" == selRdmgdsMod) {

                    nextStepName = "70-通知转货权(银行)";
                }
            } else if (2 == flag){

                if ("01" == pymtmod||"02" == pymtmod) {

                    nextStepName = "65-选择赎货方式(供应链)";
                } else if ("03" == pymtmod) {

                    nextStepName = "66-选择赎货方式并支付(供应链)";

                }
            }

        } else if ("68" == currStep) {//68-质押置换(供应链)
            if (1 == flag) {

                if ("02" == selRdmgdsMod) {

                    nextStepName = "69-出质通知转货权(银行)";
                }

            } else if (2 == flag){

                 if ("01" == pymtmod||"02" == pymtmod) {

                     nextStepName = "65-选择赎货方式(供应链)";


                }  else  if ("03" == pymtmod) {

                     nextStepName = "66-选择赎货方式并支付(供应链)";

                }
            }

        } else if ("69" == currStep) {//69-出质通知转货权(银行)
            if (1 == flag) {

                if ("02" == selRdmgdsMod) {

                    nextStepName = "71-通知转货权(供应链)";
                }
            } else if (2 == flag)
                nextStepName = "68-质押置换(供应链)";
        } else if ("70" == currStep) {//70-通知转货权(银行)
            if (1 == flag) {
                if ("01" == selRdmgdsMod) {

                    nextStepName = "71-通知转货权(供应链)";
                }
            } else if (2 == flag)
                nextStepName = "67-回款赎货(融资企业)";
        } else if ("71" == currStep) {//71-通知转货权(供应链)
            if (1 == flag) {

                if ("01" == selRdmgdsMod) {

                    nextStepName = "72-转货权1(仓储)";
                } else if ("02" == selRdmgdsMod) {

                    nextStepName = "73-转货权1确定质押(仓储)";
                }

            } else if (2 == flag){

                if ("01" == selRdmgdsMod) {

                    nextStepName = "70-通知转货权(银行)";

                }  else  if ("02" == selRdmgdsMod) {
                    nextStepName = "69-出质通知转货权(银行)";
                }
            }

        } else if ("72" == currStep) {//72-转货权1(仓储)
            if (1 == flag) {
                if ("01" == selRdmgdsMod) {

                    nextStepName = "77-提取货物(融资企业)";
                }
            } else if (2 == flag)
                nextStepName = "71-通知转货权(供应链)";
        } else if ("73" == currStep) {//73-转货权1确定质押(仓储)
            if (1 == flag) {

                if ("02" == selRdmgdsMod) {

                    nextStepName = "74-存入自有货物回款赎货(融资企业)";
                }

            } else if (2 == flag)
                nextStepName = "71-通知转货权(供应链)";
        } else if ("74" == currStep) {//74-存入自有货物回款赎货(融资企业)
            if (1 == flag) {
                if ("02" == selRdmgdsMod) {

                    nextStepName = "75-通知解押(银行)";
                }
            } else if (2 == flag)
                nextStepName = "73-转货权1确定质押(仓储)";
        } else if ("75" == currStep) {//75-通知解押(银行)
            if (1 == flag) {
                if ("02" == selRdmgdsMod) {

                    nextStepName = "76-转货权2(仓储)";
                }
            } else if (2 == flag)
                nextStepName = "74-存入自有货物回款赎货(融资企业)";
        } else if ("76" == currStep) {//76-转货权2(仓储)
            if (1 == flag) {
                if ("02" == selRdmgdsMod) {

                    nextStepName = "77-提取货物(融资企业)";
                }
            } else if (2 == flag)
                nextStepName = "75-通知解押(银行)";
        }else if ("77" == currStep) {
            if (1 == flag) {

                nextStepName = "79-发货终止(供应链)";

            } else if (2 == flag)
                nextStepName = "76-转货权2(仓储)";
        }


        if (""==nextStepName) {
            if (1 == flag) {
                nextStepName="下一步";

            }else if (2 == flag){
                nextStepName="上一步";
            }
        }



        return nextStepName;
    }


    /***
     * 订单提交
     */
    function submitSpg() {
        for (instance in CKEDITOR.instances) {
            CKEDITOR.instances[instance].updateElement();
        }

        /*接货承运 物流公司信息*/
        $('#frm_submit_ar [name="vhclNum"]').val($('#vhclNum_spe').val());
        $('#frm_submit_ar [name="tprtModAndImt"]').val($('#tprtModAndImt_spe').val());
        $('#frm_submit_ar [name="lgstcCo"]').val($('#lgstcCo_spe').val());
        $('#frm_submit_ar [name="revMnyPsn"]').val($('#revMnyPsn_spe').val());
        $('#frm_submit_ar [name="revMnyCtcTel"]').val($('#revMnyCtcTel_spe').val());
        $('#frm_submit_ar [name="revMnyRmrk"]').val($('#revMnyRmrk_spe').val());


        /*接货入仓 仓储公司信息*/
        $('#frm_submit_ar [name="stgco"]').val($('#stgco_spe').val());
        $('#frm_submit_ar [name="intrsrPsn"]').val($('#intrsrPsn_spe').val());
        $('#frm_submit_ar [name="intrsrRmrk"]').val($('#intrsrRmrk_spe').val());
        $('#frm_submit_ar [name="plgSt"]').val($('#plgSt_spe').val());
        $('#frm_submit_ar [name="strBit"]').val($('#strBit_spe').val());
        $('#frm_submit_ar [name="plgWarnStcd"]').val($('#plgWarnStcd_spe').val());

        var formParams = E7.serialForm('#frm_submit_ar');


        // 取订单明细表格的数据
        var all = $('#boot-table-kc').bootstrapTable('getData');

        var fileUrl2 = document.getElementById("fileId2").value;

        E7.post(pageSetting.resetPath + '/submitSpg', {inVo:JSON.stringify(formParams), detail:JSON.stringify(all), fileUrl2:fileUrl2}, function(data) {

            showOrHideDetail(true, 1);
            bootbox.alert({
                'title': "消息",
                'message': '提交成功！'
            });
            $('#tbl_query').e7table(
                'reload',
                function () {
                    if (formParams['id'] != '') {
                        $('#tbl_query').e7table('selectById',
                            formParams['id']);
                    }
                });
        });
    }

    /***
     * 显示发起对话框
     */
    function showAddDialog() {
        // 初始化上传附件控件
        initInputItem(1);
        E7.resetForm('#frm_detail');
        //		CKEDITOR.instances.editor1.setData('');
        $('#frm_detail').data('bootstrapValidator').resetForm(true);
        showOrHideDetail(true, 2);
    }

    /***
     * 表单校验控件初始化2(订单各环节提交)
     */
    function validator_2_Init() {
        $('#frm_submit_ar').bootstrapValidator({
            feedbackIcons: {
                valid: 'glyphicon glyphicon-ok',
                invalid: 'glyphicon glyphicon-remove',
                validating: 'glyphicon glyphicon-refresh'
            },
            fields: {
                "aplyPsrltCd": {
                    validators: {
                        notEmpty: {
                            message: '处理结果不能为空'
                        }
                    }
                }
            }
        });

        $('#btn_submit_ar').click(function () {
            $('#frm_submit_ar').bootstrapValidator('validate');
        });
    }

    /***
     * 表单校验控件初始化1（订单发起提交）
     */
    function validator_1_Init() {
        $('#frm_detail').bootstrapValidator({
            feedbackIcons: {
                valid: 'glyphicon glyphicon-ok',
                invalid: 'glyphicon glyphicon-remove',
                validating: 'glyphicon glyphicon-refresh'
            },
            fields: {
                "arTp": {
                    validators: {
                        notEmpty: {
                            message: '订单类型不能为空'
                        }
                    }
                },
                "fncEntp": {
                    validators: {
                        notEmpty: {
                            message: '融资企业不能为空'
                        }
                    }
                },
                "ustrmSplr": {
                    validators: {
                        notEmpty: {
                            message: '上游供应商不能为空'
                        }
                    }
                },
                "stgco": {
                    validators: {
                        notEmpty: {
                            message: '仓储公司不能为空'
                        }
                    }
                },
                "bnk": {
                    validators: {
                        notEmpty: {
                            message: '银行不能为空'
                        }
                    }
                },
                "lgstcCo": {
                    validators: {
                        notEmpty: {
                            message: '物流公司不能为空'
                        }
                    }
                },
                "insCo": {
                    validators: {
                        notEmpty: {
                            message: '保险公司不能为空'
                        }
                    }
                },
                "splchainCo": {
                    validators: {
                        notEmpty: {
                            message: '供应链公司不能为空'
                        }
                    }
                },
                "pckupgdsCyc": {
                    validators: {
                        notEmpty: {
                            message: '提货周期不能为空'
                        },
                        digits: {
                            message: '提货周期只能输入数字'
                        }
                    }
                },
                "btp": {
                    validators: {
                        notEmpty: {
                            message: '业务类型不能为空'
                        }
                    }
                },
                "fncPctg": {
                    validators: {
                        notEmpty: {
                            message: '融资比例不能为空'
                        },
                        digits: {
                            message: '输入只能为0~100的数字'
                        },
                        greaterThan: {
                            value: 0,
                            message: '输入不能小于0'
                        },
                        lessThan: {
                            value: 101,
                            message: '输入不能超过100'
                        }
                    }
                },
                "prpyGldRto": {
                    validators: {
                        notEmpty: {
                            message: '预付金比率不能为空'
                        },
                        digits: {
                            message: '输入只能为数字'
                        },
                        greaterThan: {
                            value: 0,
                            message: '输入不能小于0'
                        },
                        lessThan: {
                            value: 101,
                            message: '输入不能超过100'
                        }
                    }
                },
                "lmt": {
                    validators: {
                        notEmpty: {
                            message: '额度不能为空'
                        },
                        digits: {
                            message: '输入只能为数字'
                        }
                    }
                },
                "crdn": {
                    validators: {
                        notEmpty: {
                            message: '警戒线不能为空'
                        },
                        digits: {
                            message: '输入只能为数字'
                        },
                        greaterThan: {
                            value: 0,
                            message: '输入不能小于0'
                        },
                        lessThan: {
                            value: 101,
                            message: '输入不能超过100'
                        }
                    }
                },
                "clsposLn": {
                    validators: {
                        notEmpty: {
                            message: '平仓线不能为空'
                        },
                        digits: {
                            message: '输入只能为数字'
                        },
                        greaterThan: {
                            value: 0,
                            message: '输入不能小于0'
                        },
                        lessThan: {
                            value: 101,
                            message: '输入不能超过100'
                        }
                    }
                },
                "svcfeeCmd": {
                    validators: {
                        notEmpty: {
                            message: '服务费收取方式不能为空'
                        }
                    }
                },
                "splovCrrovMod": {
                    validators: {
                        notEmpty: {
                            message: '溢短结转方式不能为空'
                        }
                    }
                },

                "plchd": {
                    validators: {
                        notEmpty: {
                            message: '投保人不能为空'
                        }
                    }
                },
                "plchdAdr": {
                    validators: {
                        notEmpty: {
                            message: '投保人地址不能为空'
                        }
                    }
                },
                "insrd": {
                    validators: {
                        notEmpty: {
                            message: '被保险人不能为空'
                        }
                    }
                },
                "insrdAdr": {
                    validators: {
                        notEmpty: {
                            message: '被保险人地址不能为空'
                        }
                    }
                },
                "fstBenf": {
                    validators: {
                        notEmpty: {
                            message: '第一受益人不能为空'
                        }
                    }
                },
                "fstBenfAdr": {
                    validators: {
                        notEmpty: {
                            message: '第一受益人地址不能为空'
                        }
                    }
                },
                "insPtyAdr": {
                    validators: {
                        notEmpty: {
                            message: '保险财产地址不能为空'
                        }
                    }
                },
                "insObjNm": {
                    validators: {
                        notEmpty: {
                            message: '保险标的名称不能为空'
                        }
                    }
                },
                "insAmt": {
                    validators: {
                        notEmpty: {
                            message: '保险金额不能为空'
                        },
                        digits: {
                            message: '输入只能为数字'
                        }
                    }
                },
                "dctbAmt": {
                    validators: {
                        notEmpty: {
                            message: '免赔额不能为空'
                        },
                        digits: {
                            message: '输入只能为数字'
                        }
                    }
                },
                "epap": {
                    validators: {
                        notEmpty: {
                            message: '特别约定不能为空'
                        }
                    }
                },
                "insStdt": {
                    trigger: "change3", //监听change动作
                    validators: {
                        notEmpty: {
                            message: '保险开始日期不能为空'
                        }
                    }
                },
                "insEddt": {
                    trigger: "change4", //监听change动作
                    validators: {
                        notEmpty: {
                            message: '保险结束日期不能为空'
                        }
                    }
                },
                "arStdt": {
                    //    		trigger:"change1", //监听change动作
                    validators: {
                        notEmpty: {
                            message: '订单开始日期不能为空'
                        }
                    }
                },
                "arEddt": {
                    //  		trigger:"change2", //监听change动作
                    validators: {
                        notEmpty: {
                            message: '订单结束日期不能为空'
                        }
                    }
                },
                "isNeedIns": {
                    validators: {
                        notEmpty: {
                            message: '投保类型不能为空'
                        }
                    }
                }
            }
        });

        $('#btn_save').click(function () {
            $('#frm_detail').bootstrapValidator('validate');
        });
    }




    function queryDetails(id, aplyPcstpCd, type) {
        // type 1:订单提交  0：订单详情查询
        //	alert([[${userType}]]);
        // 带过来的环节编号
        $('#frm_submit_ar [name="aplyPcstpCd"]').val(aplyPcstpCd);

        if ($('#frm_detail').data('bootstrapValidator')) {
            $('#frm_detail').data('bootstrapValidator').resetForm(true);
        }
        E7
            .post(
                pageSetting.resetPath + '/getDetail',
                {
                    'id': id, 'aplyPcstpCd': aplyPcstpCd, 'type': type
                },
                function (result) {
                    fillForm('#frm_detail', result.data);
                    var detail = result.data;
                    for (key in detail) {
                        $('#frm_detail [name="' + key + '"]').val(
                            detail[key]);
                    }

                    $('#frm_submit_ar [name="spgId"]').val(detail["spgId"]);
                    $('#frm_submit_ar [name="arId"]').val(detail["arId"]);

                    $('#frm_submit_ar [name="ordrId"]').val(detail["ordrId"]);
                    $('#frm_submit_ar [name="pymtMod"]').val(detail["pymtMod"]);

                    $('#frm_submit_ar [name="selRdmgdsMod1"]').val(detail["selRdmgdsMod"]);
                    // 订单详情div标题
                    $('#main_edit_detail_title').text("发货信息 [ " + detail["spgId"] + " ]");


                    ///订单明细信息
                    var t7SpgDetailList = detail["t7SpgDetailList"];
                    $("#boot_table_div").hide();
                    var rows = [];
                    $("#boot-table").bootstrapTable('removeAll');
                    for (var jj = 0; jj < t7SpgDetailList.length; jj++) {
                        rows.push({
                        	ids:t7SpgDetailList[jj].ids,
                            pdNm: t7SpgDetailList[jj].pdNm,
                            spec: t7SpgDetailList[jj].spec,
                            modl: t7SpgDetailList[jj].modl,
                            qlyStd: t7SpgDetailList[jj].qlyStd,
                            brnd: t7SpgDetailList[jj].brnd,
                            pdFctr: t7SpgDetailList[jj].pdFctr,
                            num: t7SpgDetailList[jj].num,
                            msunit:t7SpgDetailList[jj].msunit,
                            pdId:t7SpgDetailList[jj].pdId,
                            operation:'<a onclick="modifyTr(this)"><i class="glyphicon glyphicon-edit"></i></a>&nbsp &nbsp<a onclick="deleteItem4(this)"><i class="glyphicon glyphicon-trash"></i></a>',


                        })

                    }
                    $('#boot-table').bootstrapTable('append', rows);

                    $('#boot-table-kc').bootstrapTable('removeAll');

                    if(aplyPcstpCd==63){

                        $('#boot_table_div_kc').show();
                        $('#boot-table-kc').bootstrapTable('append', rows);
                    }else{
                        $('#boot_table_div_kc').hide();
                    }


                    // 根据角色不同控制数据展示
                    var datas = detail["roleParmsList"];
                    if (null != datas) {
                        for (var i = 0; i < datas.length; i++) {
                            // 控制界面控件是否显示
                            $('#' + datas[i] + '_div').hide();
                            // 控制表格的列是否显示
                            var colEng = transToEng(datas[i]);
                            if ("" != colEng) {
                                $('#boot-table').bootstrapTable(
                                    'hideColumn', colEng);
                            }
                        }
                    }
                    $("#boot_table_div").fadeIn(800);

                    ///附件列表
                    var td = detail["t2UploadAtch01List"];
                    insertHtml = "";
                    for (var kk = 0; kk < td.length; kk++) {
                        insertHtml = insertHtml
                            + '<div class="col-sm-2"><i class="iconfont icon-kl-fujian"></i><a href="' + td[kk].srFileRte + '" target="_blank"><div>'
                            + td[kk].oriFileNm + '<p>'
                            + getFileType(td[kk].oriFileNm)
                            + '</div></a></div>';
                    }
                    if (td.length > 0) {
                        var testdiv = document
                            .getElementById("upload_atch_div");
                        testdiv.innerHTML = insertHtml;
                        $('#query_ar_atch_div').fadeIn(800);
                    } else {
                        $('#query_ar_atch_div').hide();
                    }
                    //				bespeakStatus = detail['bespeakStatus'];
                    ///环节流转列表table生成
                    var lnk_jrnl_inf = detail["list"];
                    insertHtml = "";
                    insertHtml = '<table id="tbl_Lnk_Jrnl_Inf2" align="center"class="table table-hover"> <thead> <tr> <th style="border-bottom: none;">环节</th><th style="border-bottom: none;">结果</th><th style="border-bottom: none;">提交人</th><th style="border-bottom: none;">公司</th><th style="border-bottom: none;">备注</th><th style="border-bottom: none;">处理时间</th><th style="border-bottom: none;">详情</th></tr> </thead><tbody>';
                    for (var jj = 0; jj < lnk_jrnl_inf.length; jj++) {
                        var rmrkDesc = lnk_jrnl_inf[jj].rmrk;
                        if ((null != rmrkDesc)
                            && (rmrkDesc.length > 5)) {
                            rmrkDesc = '<a onclick=getArSubmmitDetail("'
                                + lnk_jrnl_inf[jj].id
                                + '","'
                                + lnk_jrnl_inf[jj].rltvId
                                + '","'
                                + lnk_jrnl_inf[jj].aplyPcstpCd
                                + '")>'
                                + rmrkDesc.substring(0, 5)
                                + "..." + '</a>';
                        }
                        if ((null == rmrkDesc) || ("" == rmrkDesc)) {
                            rmrkDesc = "无";
                        }
                     // 是否显示查看详情按钮
						var buttonHtml = '无';
						if ('61' != lnk_jrnl_inf[jj].aplyPcstpCd)
							buttonHtml ='<input type="button" class="btn-success btn_small" onclick=getArSubmmitDetail("'
						+ lnk_jrnl_inf[jj].id + '","'
						+ lnk_jrnl_inf[jj].rltvId + '","'
						+ lnk_jrnl_inf[jj].aplyPcstpCd
						+ '") value="查看">';
						
						insertHtml = insertHtml
								+ '<tr><td>'
								+ transAplyPcstpCd(lnk_jrnl_inf[jj].aplyPcstpCd)
								+ '</td><td>'
								+ transAplyPsrltCd(lnk_jrnl_inf[jj].aplyPsrltCd)
								+ '</td><td>'
								+ lnk_jrnl_inf[jj].username
								+ '</td><td>'
								+ lnk_jrnl_inf[jj].companyName
								+ '</td><td>'
								+ rmrkDesc
								+ '</td><td>'
								+ transDateTime(lnk_jrnl_inf[jj].lnkEdtm)
								+ '</td><td>' + buttonHtml + ' </td></tr>';
                    }
                    insertHtml = insertHtml + "</tbody></table>";
                    testdiv = document
                        .getElementById("lnk_jrnl_inf_tbl_div");
                    // 订单流转div标题
                    $('#ar_lnk_jrnl_inf_detail_title').text(
                        "流转信息 [ " + detail["spgId"] + " ]");
                    // 订单提交div标题
                    var titleDesc = "发货"
                        + transAplyPcstpCd(aplyPcstpCd);
                    $('#submit_ar_detail_title').text(
                        "您所在位置 : 发货管理 > 待审批发货 > " + titleDesc
                        + " [ " + detail["spgId"]
                        + " ]");
                    // 订单提交详情查询div标题
                    $('#query_ar_submmit_title').text(
                        "发货提交详情 [ " + detail["spgId"] + " ]");

                    testdiv.innerHTML = insertHtml;


                    // 审批提交个性化参数
                    $('#aplyPsrltDiv').empty();
                    var aplyPsrlt = detail["aplyPsrlt"];
                    if (aplyPsrlt !== null || aplyPsrlt !== undefined || aplyPsrlt !== '')
                        $("#aplyPsrltDiv").append(aplyPsrlt);


                    // 决定显示哪一个返回按钮
                    if (type == 1) {
                        // 返回到订单详情查询
                        $('#btn_close_return4').fadeIn(800);
                        $('#btn_close_return3').hide();
                    } else {

                        // 返回到订单提交
                        $('#btn_close_return3').fadeIn(800);
                        $('#btn_close_return4').hide();
                    }
                });
    }



    /***
     * 添加订单明细到页面表格
     */
    function addOrderDetail() {

        var count = 0;
        var preIds = $('#ids').val();
        if("" == preIds || undefined == preIds || null == preIds){
            var all = $('#boot-table').bootstrapTable('getData');
            for(var i=0;i<all.length;i++){
                if(parseInt(all[i]["ids"])>count)
                    count=all[i]["ids"];
            }
            count=parseInt(count)+1;
        } else {
            // 删除旧的数据行
            var ids = [];//定义一个数组
            ids.push(parseInt(preIds));
            $('#boot-table-kc').bootstrapTable('remove', { field: 'ids', values: ids});
            // 修改后的数据序号不变
            count = preIds;
        }


        var rows=[];
        rows.push({
            ids:count,
        	pdNm:$("#pdNm").find("option:selected").text(),
        	spec:$('#spec').val(),
        	modl:$('#modl').val(),
        	qlyStd:$('#qlyStd').val(),
        	brnd:$('#brnd').val(),
        	pdFctr:$('#pdFctr').val(),
        	num:$('#num').val(),
        	msunit:$('#msunit').val(),
        	pdId:$('#pdNm').val(),
            operation:'<a onclick="modifyTr(this)"><i class="glyphicon glyphicon-edit"></i></a>&nbsp &nbsp<a onclick="deleteItem4(this)"><i class="glyphicon glyphicon-trash"></i></a>',

        })
        $('#boot-table-kc').bootstrapTable('append', rows);
//        $('#boot-table').bootstrapTable('hideColumn', 'pdNm');
        $("#boot_table_div").fadeIn(800);
        $("#orderDetailModal").modal("hide");
    }
    // 修改行
    function modifyTr(input) {
		$('#ids').val($(input).parent().parent().find('td').eq(0).text());
		$('#pdNm').val($(input).parent().parent().find('td').eq(1).text());
		$('#spec').val($(input).parent().parent().find('td').eq(2).text());
		$('#modl').val($(input).parent().parent().find('td').eq(3).text());
		$('#qlyStd').val($(input).parent().parent().find('td').eq(4).text());
		$('#pdFctr').val($(input).parent().parent().find('td').eq(5).text());
		$('#msunit').val($(input).parent().parent().find('td').eq(6).text());
		$('#pchUnitprc').val($(input).parent().parent().find('td').eq(7).text());
		$('#pdId').val($(input).parent().parent().find('td').eq(8).text());
        // 按钮控制
        $('#btn_modify_order_detail').show();
        $('#btn_add_order_detail').hide();
        $('#orderDetailModal').modal('show');
    }


    function deleteItem4(input) {
        var id = $(input).parent().parent().find('td').eq(0).text();
        var ids = [];//定义一个数组
        ids.push(parseInt(id));
        $('#boot-table-kc').bootstrapTable('remove', { field: 'ids', values: ids});
    }


    function getArSubmmitDetail(id, arId, aplyPcstpCd) {
        // 带过来的环节编号
        E7
            .post(
                pageSetting.resetPath + '/getSpgSubmmitDetail',
                {
                    'id': id,
                    'arId': arId,
                    'aplyPcstpCd': aplyPcstpCd
                },
                function (result) {

                    var detail = result.data;


                    // 个人化审批参数查询展示
                    var testdiv22 = document
                        .getElementById("query_order_submmit_div");

                    var aplyPsrlt = detail["aplyPsrlt"];

                    if (null != aplyPsrlt && undefined != aplyPsrlt) {

                        testdiv22.innerHTML = detail["aplyPsrlt"];
                    }


                    $('#fld_detail_query_order_submmit').prop('disabled', true);
                    ///附件列表
                    var td = detail["t2UploadAtch01List"];
                    var insertHtml = "";
                    $('#query_ar_atch_div2').hide();
                    if (null != td && undefined != td) {
                        for (var kk = 0; kk < td.length; kk++) {
                            insertHtml = insertHtml
                                + '<div class="col-sm-2"><i class="iconfont icon-kl-fujian"></i><a href="' + td[kk].srFileRte + '" target="_blank"><div>'
                                + td[kk].oriFileNm + '<p>'
                                + getFileType(td[kk].oriFileNm)
                                + transDateTime(suffix)
                                + '</div></a></div>';
                        }
                        if (td.length > 0) {
                            var testdiv = document
                                .getElementById("upload_atch_div2");
                            testdiv.innerHTML = insertHtml;
                            $('#query_ar_atch_div2').fadeIn(800);
                        } else {
                            $('#query_ar_atch_div2').hide();
                        }
                    }
                    showOrHideDetail(false, 5);
                });
    }

    function showViewSubmit(id, aplyPcstpCd) {
        E7.resetForm('#frm_submit_ar');
        $('#frm_submit_ar').data('bootstrapValidator').updateStatus(
            'aplyPsrltCd', 'NOT_VALIDATED', null).validateField(
            'aplyPsrltCd');
        // 初始化上传附件控件
        initInputItem(2);
        queryDetails(id, aplyPcstpCd, 1);// flag 1:订单提交  0：订单详情查询
        showOrHideDetail(false, 4);
    }

    function showDetailDialog() {

        var rows = $('#tbl_query').e7table('getSelectedRows');
        if (rows.length == 0) {
            bootbox.alert({
                'title': '错误消息',
                'message': '请选择数据！'
            });
            return;
        } else if (rows.length > 1) {
            bootbox.alert({
                'title': '错误消息',
                'message': '一次只能修改一条数据！'
            });
            return;
        }
        if ($('#frm_detail').data('bootstrapValidator')) {
            $('#frm_detail').data('bootstrapValidator').resetForm(true);
        }
        queryDetails(rows[0]['id'], "", 0);// flag 1:订单提交  0：订单详情查询
        showOrHideDetail(false, 3);
    }

    function confirmArUndo() {
        var rows = $('#tbl_query').e7table('getSelectedRows');
        if (rows.length == 0) {
            bootbox.alert({
                'title': '错误消息',
                'message': '请选择数据！'
            });
            return;
        } else if (rows.length > 1) {
            bootbox.alert({
                'title': '错误消息',
                'message': '一次只能撤销一条发货单！'
            });
            return;
        }
        $('#arUndoModal').modal('show');
    }

    function spgUndo() {
        var rows = $('#tbl_query').e7table('getSelectedRows');
 /*        if (rows.length == 0) {
            bootbox.alert({
                'title': '错误消息',
                'message': '请选择数据！'
            });
            return;
        } else if (rows.length > 1) {
            bootbox.alert({
                'title': '错误消息',
                'message': '一次只能撤销一条发货单！'
            });
            return;
        } */
        if ($('#frm_detail').data('bootstrapValidator')) {
            $('#frm_detail').data('bootstrapValidator').resetForm(true);
        }
        E7.post(pageSetting.resetPath + '/unDoSpg', {
            'id': rows[0]['id']
        }, function (result) {
            query_ar_list();
            bootbox.alert({
                'title': "消息",
                'message': '发货单撤销成功!'
            });
        });
    }

    function del() {
        var rows = $('#tbl_query').e7table('getSelectedRows');
        if (rows.length == 0) {
            bootbox.alert({
                'title': '错误消息',
                'message': '请选择数据！'
            });
            return;
        } else if (rows.length > 1) {
            bootbox.alert({
                'title': '错误消息',
                'message': '一次只能修改一条数据！'
            });
            return;
        }
        if ($('#frm_detail').data('bootstrapValidator')) {
            $('#frm_detail').data('bootstrapValidator').resetForm(true);
        }
        E7.post(pageSetting.resetPath + '/deleteAr', {
            'id': rows[0]['id']
        }, function (result) {
            query_ar_list();
            bootbox.alert({
                'title': "消息",
                'message': '删除成功！'
            });
        });
    }

    function validate_frm_detail() {
        $('#frm_detail').bootstrapValidator('validate');
        if (!$('#frm_detail').data('bootstrapValidator').isValid()) {
            return;
        } else {
            $('#saveSubmitModal').modal('show');
        }
    }

    function save() {
        for (instance in CKEDITOR.instances) {
            CKEDITOR.instances[instance].updateElement();
        }

        var formParams = E7.serialForm('#frm_detail');
        E7.post(pageSetting.resetPath + '/save', {inVo: JSON.stringify(formParams), detail: "", fileUrl: ""},
            function (data) {
                query_ar_list();
                //showOrHideDetail(true, 1);
                bootbox.alert({
                    'title': "消息",
                    'message': '订单发起成功！'
                });
                $('#tbl_query').e7table(
                    'reload',
                    function () {
                        if (formParams['id'] != '') {
                            $('#tbl_query').e7table('selectById',
                                formParams['id']);
                        }
                    });
            });
    }

    function showEditDialog(disable) {
        var rows = $('#tbl_query').e7table('getSelectedRows');
        if (rows.length == 0) {
            bootbox.alert({
                'title': '错误消息',
                'message': '请选择数据！'
            });
            return;
        } else if (rows.length > 1) {
            bootbox.alert({
                'title': '错误消息',
                'message': '一次只能修改一条数据！'
            });
            return;
        }
        if ($('#frm_detail').data('bootstrapValidator')) {
            $('#frm_detail').data('bootstrapValidator').resetForm(true);
        }
        E7
            .post(
                pageSetting.resetPath + '/getDetail',
                {
                    'id': rows[0]['id']
                },
                function (result) {
                    fillForm('#frm_detail', result.data);
                    // 实时判断订单是否可以修改
                    if (result.data["aplyPcstpCd"] != "01") {
                        bootbox
                            .alert({
                                'title': '错误消息',
                                'message': '当前订单不在发起环节禁止修改！请退回到发起环节再修改。'
                            });
                        return;
                    }
                    // 多次修改，清空上次div追加的内容
                    $("#fujianId").empty();
                    if (result.data.t2UploadAtch01List != undefined) {
                        for (i = 0; i < result.data.t2UploadAtch01List.length; i++) {
                            var elem = result.data.t2UploadAtch01List[i];
                            /* 										var item = '<div name="inputDiv">'
                             + elem.oriFileNm
                             + '<input name="fileName" type="file" src="'+elem.oriFileNm+'"  class="form-control" value="'+elem.oriFileNm+'"/><a onclick="deleteItem(this)">删除</a> <br/></div>'; */
                            var atchId = elem.id;
                            var item = '<div name="inputDiv"> <a href="' + elem.srFileRte + '" target="_blank">'
                                + elem.oriFileNm
                                + '&nbsp&nbsp</a>&nbsp&nbsp<a onclick="deleteItem2(this, '
                                + elem.id
                                + ')"> 删除</a> <br/></div>';

                            $("#fujianId").append(item);
                        }
                    }
                    showOrHideDetail(true, 6);

                });
    }

    fillForm = function (frm, data, reset, parent) {
        if (E7.isEmpty(parent)
            && (E7.getType(reset) == 'undefined' || reset))
            E7.resetForm(frm);
        for (var key in data) {
            var elName = E7.isEmpty(parent) ? key : (parent + '.' + key);
            var elValue = data[key];

            if (elValue == null)
                continue;
            if (E7.getType(elValue) == 'object') {
                E7.fillForm(frm, elValue, false, elName);
                continue;
            }
            var els = $(frm + ' [name="' + elName + '"]');
            if (els.length == 0)
                continue;
            if (els[0].type == 'radio') {
                $(frm + ' [name="' + elName + '"][value="' + elValue + '"]')
                    .prop("checked", true);
            } else if (els[0].type == 'select-multiple') {
                if (elValue instanceof Array) {
                    els.val(elValue);
                } else if (typeof elValue == 'string') {
                    els.val(elValue.split(','));
                } else if (typeof elValue == 'number') {
                    els.val(elValue + '');
                } else {
                    els.val(elValue);
                }
            } else if (els[0].type == 'checkbox') {
                if (els.length == 1) {
                    if (els.val() == elValue) {
                        els.prop('checked', true);
                    }
                } else {
                    if (elValue instanceof Array) {
                        els.val(elValue);
                    } else if (typeof elValue == 'string') {
                        els.val(elValue.split(','));
                    } else if (typeof elValue == 'number') {
                        els.val(elValue + '');
                    } else {
                        els.val(elValue);
                    }
                }
            } else if (els[0].id == 'editor1') {
                CKEDITOR.instances.editor1.setData(elValue);
            } else {
                els.val(elValue + '');
            }
        }
    }

    function submitTransferFile(flag) {
        if (flag == 1) {
            var file = document.getElementsByName("fileName")
            //var file = $('.select-file').files//document.getElementById("file_transfer").files;
            //TODO:valid
            var formData = new FormData();
            for (i = 0; i < file.length; i++) {
                formData.append('file', file[i].files[0]);
            }
            E7.postMultipart('[[@{/spgManagement/ossUpload}]]', formData,
                function (result) {
                    var fileUrl = result.data;
                    $("#fileId").val(fileUrl);
                    bootbox.alert({
                        'title': '消息',
                        'message': '上传成功, 文件：<code>' + result.data
                            + '</code>！'
                    });
                });
        } else if (flag == 2) {
            var file = document.getElementsByName("fileName2")
            //var file = $('.select-file').files//document.getElementById("file_transfer").files;
            //TODO:valid
            var formData = new FormData();
            for (i = 0; i < file.length; i++) {
                formData.append('file', file[i].files[0]);
            }
            E7.postMultipart('[[@{/spgManagement/ossUpload}]]', formData,
                function (result) {
                    var fileUrl2 = result.data;
                    $("#fileId2").val(fileUrl2);
                    bootbox.alert({
                        'title': '消息',
                        'message': '上传成功, 文件：<code>' + result.data
                            + '</code>！'
                    });
                });
        }
    }

    function addInputItem(flag) {

        if (flag == 1) {
            var item = '<div name="inputDiv"><input name="fileName" type="file"  class="form-control"/><a onclick="deleteItem(this)">删除</a> <br/></div>';
            $("#fujianId").append(item);
        } else if (flag == 2) {
            var item = '<div name="inputDiv"><input name="fileName2" type="file"  class="form-control"/><a onclick="deleteItem(this)">删除</a> <br/></div>';
            $("#fujianId2").append(item);
        }
    }

    function initInputItem(flag) {

        if (flag == 1) {
            var item = '<div name="inputDiv"><input name="fileName" type="file"  class="form-control"/><a onclick="deleteItem(this)">删除</a> <br/></div>';
            var testdiv = document.getElementById("fujianId");
            testdiv.innerHTML = item;
        } else if (flag == 2) {
            var item = '<div name="inputDiv"><input name="fileName2" type="file"  class="form-control"/><a onclick="deleteItem(this)">删除</a> <br/></div>';
            var testdiv = document.getElementById("fujianId2");
            testdiv.innerHTML = item;
        }
    }

    function deleteItem(input) {
        $(input).parent().remove();
    }

    function deleteItem2(input, id) {
        var preValue = $("#fileToDeleteId").val();
        if (preValue == null || preValue == "")
            $("#fileToDeleteId").val(id);
        else
            $("#fileToDeleteId").val(preValue + "||" + id);

        $(input).parent().remove();
    }

    function buttonInit() {
        if ('[[${userType}]]' == 'Group') {

            $("#div_buttons")
                .append(
                    '<button type="button" class="btn btn-primary-red btn-sm" onclick="javascript:confirmArUndo();" style="margin-left:20px;"><i class="glyphicon glyphicon-minus-sign"></i>撤销</button>');
            $("#div_buttons")
                .append(
                    '<button type="button" class="btn btn-sm btn-primary-gray pull-right" onclick="javascript:reset()"><i class="glyphicon glyphicon-refresh"></i>重置</button>');
            $("#div_buttons")
                .append(
                    '<button id="btn_search"  type="button" class="btn btn-primary-gray btn-sm pull-right" onclick="javascript:query_ar_list()" style="margin-right:15px;"><i class="glyphicon glyphicon-search"></i>查询</button>');
        } else {
            $("#div_buttons")
                .append(
                    '<button class="btn btn-default" onclick="javascript:showViewDialog1();">查看33</button>');
            $("#div_buttons")
                .append(
                    '<button class="btn btn-default pull-right" onclick="javascript:reset()">重置</button>');
            $("#div_buttons")
                .append(
                    '<button class="btn btn-primary pull-right" onclick="javascript:query_ar_list()" style="margin-right:15px;">查询</button>');
        }
    }

    /***
     * e7table表格控件初始化
     */
    function e7tableInit() {
        $('#tbl_query')
            .e7table(
                {
                    url: '[[@{/spgManagement/queryPage_adt}]]',
                    pageSize: 10,
                    autoLoading: true, //控件初始化后，自动远程请求数据
                    selectType: 'single',
                    sortName: 'crtTm', //排序列名,创建时间
                    striped: false, //奇偶行不同背景
                    pagination: true,
                    rownumbers: false, //如果为true，则显示一个行号列
                    sortOrder: 'desc', //排序方向
                    columns: [
                        {
                            title: '长约编号',
                            field: 'arId',
                            sortable: true
                        },
                        {
                            title: '订单编号',
                            field: 'ordrId',
                            sortable: true
                        },
                        {
                            title: '发货编号',
                            field: 'spgId',
                            sortable: true
                        },
                        {
                            title: '发货人',
                            field: 'spgPsn',
                            sortable: true
                        },


                        {
                            title: '收货人',
                            field: 'cnsgn',
                            sortable: true
                        },


                        {
                            title: '目的地',
                            field: 'ppsLnd',
                            sortable: true
                        },

                        {
                            title: '发起时间',
                            field: 'crtTm',
                            sortable: true,
                            formatter: function (value, row,
                                                 index) {
                                return transDateTime(value);
                            }
                        },
                        {
                            title: '环节',
                            field: 'aplyPcstpCd',
                            sortable: true,
                            formatter: function (value, row,
                                                 index) {
                                return transAplyPcstpCd(value);
                            }
                        },


                        {
                            title: '操作',
                            field: 'aplyPcstpCd',
                            formatter: function (value, row,
                                                 index) {
                                if (value == '61') {
                                    var s = '<button class="btn-success btn_small" onclick=showViewSubmit('
                                        + row.id
                                        + ',"'
                                        + value
                                        + '")>发货发起_上游</button>&nbsp;';
                                    return s;
                                } else if (value == '62') {
                                    var s = '<button class="btn-success btn_small" onclick=showViewSubmit('
                                        + row.id
                                        + ',"'
                                        + value
                                        + '")>接货承运_物流</button>&nbsp;';
                                    return s;
                                } else if (value == '63') {
                                    var s = '<button class="btn-success btn_small" onclick=showViewSubmit('
                                        + row.id
                                        + ',"'
                                        + value
                                        + '")>接货入库_仓储</button>&nbsp;';
                                    return s;
                                } else if (value == '64') {
                                    var s = '<button class="btn-success btn_small" onclick=showViewSubmit('
                                        + row.id
                                        + ',"'
                                        + value
                                        + '")>货款支付_供应链</button>&nbsp;';
                                    return s;
                                } else if (value == '65') {
                                    var s = '<button class="btn-success btn_small" onclick=showViewSubmit('
                                        + row.id
                                        + ',"'
                                        + value
                                        + '")>选择赎货方式_供应链</button>&nbsp;';
                                    return s;
                                } else if (value == '66') {
                                    var s = '<button class="btn-success btn_small" onclick=showViewSubmit('
                                        + row.id
                                        + ',"'
                                        + value
                                        + '")>选择赎货方式并支付_供应链</button>&nbsp;';
                                    return s;
                                } else if (value == '67') {
                                    var s = '<button class="btn-success btn_small" onclick=showViewSubmit('
                                        + row.id
                                        + ',"'
                                        + value
                                        + '")>回款赎货_融资企业</button>&nbsp;';
                                    return s;
                                } else if (value == '68') {
                                    var s = '<button class="btn-success btn_small" onclick=showViewSubmit('
                                        + row.id
                                        + ',"'
                                        + value
                                        + '")>质押置换_供应链</button>&nbsp;';
                                    return s;
                                } else if (value == '69') {
                                    var s = '<button class="btn-success btn_small" onclick=showViewSubmit('
                                        + row.id
                                        + ',"'
                                        + value
                                        + '")>出质通知转货权_银行</button>&nbsp;';
                                    return s;
                                } else if (value == '70') {
                                    var s = '<button class="btn-success btn_small" onclick=showViewSubmit('
                                        + row.id
                                        + ',"'
                                        + value
                                        + '")>通知转货权_银行</button>&nbsp;';
                                    return s;
                                } else if (value == '71') {
                                    var s = '<button class="btn-success btn_small" onclick=showViewSubmit('
                                        + row.id
                                        + ',"'
                                        + value
                                        + '")>通知转货权_供应链</button>&nbsp;';
                                    return s;
                                } else if (value == '72') {
                                    var s = '<button class="btn-success btn_small" onclick=showViewSubmit('
                                        + row.id
                                        + ',"'
                                        + value
                                        + '")>转货权1_仓储</button>&nbsp;';
                                    return s;
                                } else if (value == '73') {
                                    var s = '<button class="btn-success btn_small" onclick=showViewSubmit('
                                        + row.id
                                        + ',"'
                                        + value
                                        + '")>转货权1确定质押_仓储</button>&nbsp;';
                                    return s;
                                } else if (value == '74') {
                                    var s = '<button class="btn-success btn_small" onclick=showViewSubmit('
                                        + row.id
                                        + ',"'
                                        + value
                                        + '")>存入自有货物回款赎货_融资企业</button>&nbsp;';
                                    return s;
                                } else if (value == '75') {
                                    var s = '<button class="btn-success btn_small" onclick=showViewSubmit('
                                        + row.id
                                        + ',"'
                                        + value
                                        + '")>通知解押_银行</button>&nbsp;';
                                    return s;
                                } else if (value == '76') {
                                    var s = '<button class="btn-success btn_small" onclick=showViewSubmit('
                                        + row.id
                                        + ',"'
                                        + value
                                        + '")>转货权2_仓储</button>&nbsp;';
                                    return s;
                                } else if (value == '77') {
                                    var s = '<button class="btn-success btn_small" onclick=showViewSubmit('
                                        + row.id
                                        + ',"'
                                        + value
                                        + '")>提取货物_融资企业</button>&nbsp;';
                                    return s;
                                } else if (value == '79') {
                                    var s = '<button class="btn-success btn_small" onclick=showViewSubmit('
                                        + row.id
                                        + ',"'
                                        + value
                                        + '")>发货终止_供应链</button>&nbsp;';
                                    return s;
                                }
                            }
                        }],
                    onDblclick: function (index, row) {
                        showDetailDialog();
                    }
                });
    }

    function show_or_hide_ins_div(flag) {

    }


    function transAplyPcstpCd(value) {
        if (value == '61') {
            return "发货发起_上游";
        } else if (value == '62') {
            return "接货承运_物流";
        } else if (value == '63') {
            return "接货入库_仓储";
        } else if (value == '64') {
            return "货款支付_供应链";
        } else if (value == '65') {
            return "选择赎货方式_供应链";
        } else if (value == '66') {
            return "选择赎货方式并支付_供应链";
            ;
        } else if (value == '67') {
            return "回款赎货_融资企业";
        } else if (value == '68') {
            return "质押置换_供应链";
        } else if (value == '69') {
            return "出质通知转货权_银行";
        } else if (value == '70') {
            return "通知转货权_银行";
        } else if (value == '71') {
            return "通知转货权_供应链";
        } else if (value == '72') {
            return "转货权1_仓储";
        } else if (value == '73') {
            return "转货权1确定质押_仓储";
        } else if (value == '74') {
            return "存入自有货物回款赎货_融资企业";
        } else if (value == '75') {
            return "通知解押_银行";
        } else if (value == '76') {
            return "转货权2_仓储";
        } else if (value == '77') {
            return "提取货物_融资企业";
        } else if (value == '79') {
            return "发货终止_供应链";
        } else
            return value;
    }


    function transToEng(cng) {
        if (cng == "品名")
            return "pdNm";
        else if (cng == "规格")
            return "spec";
        else if (cng == "型号")
            return "modl";
        else if (cng == "质量标准")
            return "qlyStd";
        else if (cng == "品牌")
            return "brnd";
        else if (cng == "生产厂家")
            return "pdFctr";
        else if (cng == "数量")
            return "num";
        else if (cng == "计量单位")
            return "msunit";
        else if (cng == "采购单价")
            return "pchUnitprc";
        else if (cng == "交易差价")
            return "txnPrcdif";
        else if (cng == "销售暂定价")
            return "saleTntvPrc";
        else
            return "";
    }
</script>
</body>
</html>
