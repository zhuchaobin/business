<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />

<meta
	content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
	name="viewport" />
<title>无模版</title>
<link rel="stylesheet"
	th:href="@{/resources/bootstrap/css/bootstrap.min.css}" />
<link rel="stylesheet"
	th:href="@{/resources/dist/css/skins/_all-skins.css}" />
<link rel="stylesheet" th:href="@{/resources/dist/css/AdminLTE.min.css}" />
<link rel="stylesheet"
	th:href="@{/resources/dist/css/font-awesome.min.css}" />
<link rel="stylesheet" th:href="@{/resources/dist/css/ionicons.min.css}" />
<link rel="stylesheet"
	th:href="@{/resources/plugins/bootstrapValidator/bootstrapValidator.min.css}" />
<link rel="stylesheet" th:href="@{/resources/e7/css/e7-0.2.css}" />
<link rel="stylesheet"
	th:href="@{/resources/e7/e7table/e7table-0.2.css}" />
<link rel="stylesheet"
	th:href="@{/resources/adminlte/dist/css/AdminLTE.css}" />
<link rel="stylesheet"
	th:href="@{/resources/adminlte/bootstrap/css/bootstrap.min.css}" />
<link rel="stylesheet"
	th:href="@{/resources/adminlte/plugins/iCheck/all.css}" />
<link rel="stylesheet" th:href="@{/resources/style.css}" />
<link rel="stylesheet"
	th:href="@{/resources/dist/kl-iconfont/iconfont.css}" />
<link rel="stylesheet"
	th:href="@{/resources/plugins/datetimepicker/css/bootstrap-datetimepicker.min.css}" />
<style type="text/css">
.btn_small {
	display: inline-block;
	padding: 1px 10px;
	margin-bottom: 0;
	font-size: 14px;
	font-weight: 400;
	line-height: 1.42857143;
	text-align: center;
	white-space: nowrap;
	vertical-align: middle;
	-ms-touch-action: manipulation;
	touch-action: manipulation;
	cursor: pointer;
	-webkit-user-select: none;
	-moz-user-select: none;
	-ms-user-select: none;
	user-select: none;
	background-image: none;
	border: 1px solid transparent;
	border-radius: 4px;
}

.form-control-transparent {
	display: block;
	width: 100%;
	height: 34px;
	padding: 6px 12px;
	font-size: 14px;
	line-height: 1.42857143;
	color: #555;
	background-color: #fff;
	background-image: none;
	border: 1px solid #ccc;
	border-radius: 4px;
	-webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0);
	box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0);
	/* -webkit-transition: border-color ease-in-out .15s,-webkit-box-shadow ease-in-out .15s; */
	-o-transition: border-color ease-in-out .15s, box-shadow ease-in-out
		.15s;
	transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
}
</style>
<!-- 页面背景图片 -->
<style type="text/css">
body {
	padding: 0;
	margin: 0;
	background: url(/resources/dist/img/page_bg.png) no-repeat;
	width: 100%;
	background-size: cover;
}
</style>
<link rel="stylesheet" th:href="@{/resources/css_zcb/common.css}" />
<!-- 自定义按钮样式 -->
<link rel="stylesheet" th:href="@{/resources/css_zcb/button.css}" />
</head>
<body>
	<!-- 列表查询 start-->
	<section id="main_search_detail" class="content">
		<!-- 条件查询 -->
		<div class="box box-info">
			<!-- 条件区域 -->
			<div class="box-body" style="padding-bottom: 0px;">
				<form id="frm_query" class="form-horizontal">
					<div id="div_criteria" class="flowlayout">
							
						<div class="col-md-6" id="起止日期_div">
								<div class="form-group">
									<label for="" class="col-sm-4 control-label">起止日期：</label>
									<div class="col-sm-8 pull-right">
										<div class="col-xs-5" style="padding: 0px;">
											<input name="queryStdt" id="arStdtDTPicker" class="form-control"
												style="padding-left: 3px;" placeholder="开始日期" />
										</div>
										<div class="col-xs-1 ">
											<label for="" class="control-label">- </label>
										</div>
										<div class="col-xs-5" style="padding: 0px;">
											<input name="queryEddt" id="arEddtDTPicker" class="form-control"
												style="padding-left: 3px;" placeholder="结束日期" />
										</div>
									</div>
								</div>
						</div>
							
						<div class="col-md-4">
							<div class="form-group">
								<label for="" class="col-sm-4 control-label">关键字：</label>
								<div class="col-sm-8">
									<input id="keyWorlds" name="keyWorlds" class="form-control"
										placeholder="搜索关键字" />
								</div>
							</div>
						</div>
						
					</div>
				</form>
			</div>

			<!-- 按钮区域 -->
			<div id="div_buttons" class="box-footer"></div>
		</div>

		<!-- 信息列表 -->
		<div class="row">
			<div class="col-xs-12">
				<div class="box box-info">
					<div class="box-body table-responsive no-padding">
						<table id="tbl_query" class="table table-hover"></table>
					</div>
				</div>
			</div>
		</div>

	</section>
	<!-- 列表查询 end-->
	
		<!-- 发起确认提示框 start-->
	<div class="modal fade" id="saveSubmitModal" tabindex="-1"
		role="dialog" aria-labelledby="submitModalLabel" aria-hidden="true">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header" align="center">
					<h4 class="modal-title">友情提示</h4>
					<button type="button" class="close" data-dismiss="modal"
						aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
				</div>
				<div class="modal-body" align="center">
					<form id="frm_detail" class="form-horizontal" >
					<fieldset id='fld_detail'>
						<div class="w-z-info" >
							<input type="hidden" id="fileId" name="fileUrl"> <input
								type="hidden" id="fileToDeleteId" name="filesToDelete">
							<input name="id" type="hidden" value="" /> <input name="arId"
								type="hidden" value="" />
							<input name="secSrvCd" type="hidden" value="01" />
							<div class="col-md-12" id="发件人_div">
								<div class="form-group">
									<label for="" class="col-sm-4 control-label">发件人：</label>
									<div class="col-sm-8">
										<input name="sndPsnUserName" class="form-control-transparent"
											style="border: 0px; background: rgba(0, 0, 0, 0);"
											value="" />
									</div>
								</div>
							</div>
							<div class="col-md-12" id="收件人_div">
								<div class="form-group">
									<label for="" class="col-sm-4 control-label">收件人：</label>
									<div class="col-sm-8">
										<input name="rcvPsnList" class="form-control-transparent"
											style="border: 0px; background: rgba(0, 0, 0, 0);"
											value="" />
									</div>
								</div>
							</div>
							<div class="col-md-12" id="发送时间_div">
								<div class="form-group">
									<label for="" class="col-sm-4 control-label">发送时间：</label>
									<div class="col-sm-8">
										<input name="msgSndTm" id="msgSndTm" class="form-control-transparent"
											style="border: 0px; background: rgba(0, 0, 0, 0);"
											value="" />
									</div>
								</div>
							</div>
							
							<div class="col-md-12" id="信息标题_div">
								<div class="form-group">
									<label for="" class="col-sm-4 control-label">标题：</label>
									<div class="col-sm-8">
										<input name="msgTitle" class="form-control-transparent"
											style="border: 0px; background: rgba(0, 0, 0, 0);"
											value="" />
									</div>
								</div>
							</div>
							<div class="row">
									<div class="col-md-12" >
										<div class="form-group" style="padding-left: 15px;">
											<div class="col-md-12" style="padding-left: 10px;background: rgba(0, 0, 0, 0);">
												<textarea name="msgCntnt" rows="8" class="form-control" margin disabled="disabled" style="border: 0px; background: #DFF0D8;">rerere</textarea>
											</div>
										</div>
									</div>
								</div>
						<!-- 	<div class="row" id="query_ar_atch_div">
								<div class="col-md-12">
									<div class="form-group">
										<label for="" class="col-sm-2 control-label"></label>
										<div class="col-sm-10">
											<div class="w-z-docx">
												<div class="w-z-d-title">附件</div>
												<div class="w-z-d-list">
													<div class="row" align="center">
														<div id="upload_atch_div"></div>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
							<div class="row" id="upload_ar_div">
								<div class="col-md-12">
									<div class="form-group">
										<label for="" class="col-sm-2 control-label">附件:</label>
										<div class="col-sm-10">
											<form id="frm_transfer" class="form-horizontal"
												enctype="multipart/form-data" method="post">
												<div id="fujianId"></div>
											</form>
											<div class="modal-footer">
												<button id="btn_save2" type="button"
													class="btn btn-primary-red"
													onclick="javascript:addInputItem(1);">
													<i class="glyphicon glyphicon-plus"></i>新增附件
												</button>
												<button id="btn_save1" type="button"
													class="btn btn-primary-red"
													onclick="javascript:submitTransferFile(1);">
													<i class="glyphicon glyphicon-upload"></i>上传
												</button>
											</div>
										</div>
									</div>
								</div>
							</div> -->
						</div>
					</fieldset>
				</form>
				
				
				</div>
				<div class="modal-footer" align="center">
					<button type="button" onclick="javascript:save()" class="btn"
						data-dismiss="modal">确定</button>
					<button type="button" class="btn" data-dismiss="modal">取消</button>
				</div>
			</div>
			<!-- /.modal-content -->
		</div>
		<!-- /.modal-dialog -->
	</div>
	
	<!-- 详细信息 start-->
	<section id="main_edit_detail" class="content" style="display: none;">
		<div id="main_edit_detail_clapse" class="box box-info">
			<div class="box-header with-border">
				<h4 id="main_edit_detail_title" class="text-info">您所在的位置: 发票信息 > 待开发票</h4>
				<div class="box-tools pull-right">
					<button class="btn btn-box-tool" data-widget="collapse">
						<i id="main_edit_detail_li" class="fa fa-minus"></i>
					</button>
				</div>
			</div>
			<div class="box-body" id="msg_content_div">
			
			</div>
			<div class="box-footer">
				<button id="btn_save" type="button"
					class="btn btn-primary pull-right"
					onclick='javascript:validate_frm_detail();'>确定</button>
				<button id="btn_close" type="button"
					class="btn btn-default pull-right"
					onclick='javascript:showOrHideDetail(true, 1);'
					style="margin-right: 15px;">取消</button>
			</div>
		</div>
	</section>
	<!-- 详细信息 end-->

	<!-- 长约流转信息 start-->
	<section id="ar_lnk_jrnl_inf_detail" class="content"
		style="display: none;">
		<div id="ar_lnk_jrnl_inf_detail_clapse_box" class="box box-info">
			<div class="box-header with-border">
				<h4 id="ar_lnk_jrnl_inf_detail_title" class="text-info">长约流转信息</h4>
				<div class="box-tools pull-right">
					<button class="btn btn-box-tool" data-widget="collapse">
						<i id="ar_lnk_jrnl_inf_detail_li" class="fa fa-minus"></i>
					</button>
				</div>
			</div>
			<div class="box-body">
				<form id="frm_detail3" class="form-horizontal">
					<fieldset id='fld_detail3'>
						<div class="w-z-info">
							<!-- 环节流水信息列表 -->
							<div class="row">
								<div class="col-xs-12">
									<div class="box box-info">
										<div class="box-body table-responsive no-padding">
											<div id="lnk_jrnl_inf_tbl_div"></div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</fieldset>
				</form>
			</div>
			<!-- 			<div class="box-footer">
			</div> -->
		</div>
	</section>
	<!-- 长约流转信息 end-->

	<!-- 提交结论 start-->
	<section id="submit_ar_detail" class="content" style="display: none;">
		<div class="box box-info">
			<div class="box-header with-border">
				<h4 id="submit_ar_detail_title" class="text-info">提交结论</h4>
				<div class="box-tools pull-right">
					<button class="btn btn-box-tool" data-widget="collapse">
						<i class="fa fa-minus"></i>
					</button>
				</div>
			</div>
			<div class="box-body">
				<form id="frm_submit_ar" class="form-horizontal">
					<input type="hidden" id="fileId2" name="fileUrl2">
					<div class="row">
						<div class="col-md-9">
							<div class="form-group">
								<label for="" class="col-sm-4 control-label">结论<span
									style="color: red">*</span></label>
								<div class="col-sm-8">
									<input type="radio" name="aplyPsrltCd" id="aplyPsrltCd"
										value="01" selected=""> 通过</input> &nbsp&nbsp&nbsp&nbsp<input
										type="radio" name="aplyPsrltCd" id="aplyPsrltCd" value="02"
										selected=""> 退回</input> <input name="arId"
										class="form-control" placeholder="" value="" type="hidden" />
									<input id="aplyPcstpCd" name="aplyPcstpCd" class="form-control"
										placeholder="" value="" type="hidden" />
								</div>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-md-9">
							<div class="form-group">
								<label for="" class="col-sm-4 control-label">备注</label>
								<div class="col-sm-8">
									<!-- <input name="maintenanceContent" class="form-control"/> -->
									<textarea name="rmrk" rows="4" class="form-control"></textarea>
								</div>
							</div>
						</div>
					</div>
					<div class="row" id="submmit_ar_upload_ar_div">
						<div class="col-md-9">
							<div class="form-group">
								<label for="" class="col-sm-4 control-label">附件</label>
								<div class="col-sm-8">
									<form id="frm_transfer" class="form-horizontal"
										enctype="multipart/form-data" method="post">
										<div id="fujianId2"></div>
									</form>
									<div class="modal-footer">
										<button id="btn_save2" type="button"
											class="btn btn-primary-red"
											onclick="javascript:addInputItem(2);">
											<i class="glyphicon glyphicon-plus"></i>新增附件
										</button>
										<button id="btn_save1" type="button"
											class="btn btn-primary-red"
											onclick="javascript:submitTransferFile(2);">
											<i class="glyphicon glyphicon-upload"></i>上传
										</button>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="box-footer">
						<button id="btn_close" type="button"
							class="btn btn-primary-gray  pull-right"
							onclick='javascript:showOrHideDetail(true, 1);'
							style="margin-right: 15px;">
							<i class="glyphicon glyphicon-remove-sign"></i>取消
						</button>
						<button id="btn_submit_ar" type="button"
							class="btn btn-primary-red  pull-right"
							onclick='javascript:validate_frm_submit_ar()'
							style="margin-right: 10px;">
							<i class="glyphicon glyphicon-ok-sign"></i>确定
						</button>
					</div>
				</form>
			</div>
		</div>
	</section>
	<!-- 提交结论 end-->
	<!-- 查看界面的返回按钮 start-->
	<div id="btn_close_div"
		style="z-index: 9999; position: fixed ! important; right: 80px; top: 25px; display: none; opacity: 0.65">
		<table width=""
			100% style="position: absolute; width: 260px; right: 0px; top: 0px;">
			<button id="btn_close_detail" type="button"
				class="btn btn-success pull-right btn-lg"
				onclick='javascript:showOrHideDetail(true, 1);'
				style="margin-right: 15px;">
				<i class="glyphicon glyphicon-arrow-left"></i> 返 回
			</button>
		</table>
	</div>
	<!-- 查看界面的返回按钮 end-->

	<!-- 查询长约提交详细信息 start-->
	<section id="query_ar_submmit_detail" style="display: none;">
		<div class="box box-info">
			<div class="box-header with-border">
				<h4 id="query_ar_submmit_title" class="text-info">长约提交详情</h4>
				<div class="box-tools pull-right">
					<button class="btn btn-box-tool" data-widget="collapse">
						<i class="fa fa-minus"></i>
					</button>
				</div>
			</div>
			<div class="box-body">
				<form id="frm_detail2" class="form-horizontal">
					<fieldset id='fld_detail'>
						<div class="w-z-info">
							<div class="col-md-12 col-md-offset-2">
								<div class="row">
									<div class="col-sm-6">
										<h5 id="submmitUsername"></h5>
									</div>
									<div class="col-sm-6">
										<h5 id="companyName"></h5>
									</div>
								</div>
							</div>

							<div class="col-md-12 col-md-offset-2">
								<div class="row">
									<div class="col-sm-6">
										<h5 id="aplyPcstpCdDesc"></h5>
									</div>
									<div class="col-sm-6">
										<h5 id="aplyPsrltCdDesc"></h5>
									</div>
								</div>
							</div>
							<div class="col-md-12 col-md-offset-2">
								<div class="row">
									<div class="col-sm-6">
										<h5 id="lnkEdtm"></h5>
									</div>
								</div>
							</div>
							<div class="col-md-12 col-md-offset-2">
								<div class="row">
									<div class="col-sm-6">
										<h5 id="rmrkDesc"></h5>
									</div>
								</div>
							</div>
							<div class="row" id="query_ar_atch_div2">
								<div class="col-md-12">
									<div class="form-group">
										<label for="" class="col-sm-2 control-label"></label>
										<div class="col-sm-8">
											<div class="w-z-docx">
												<div class="w-z-d-title">附件</div>
												<div class="w-z-d-list">
													<div class="row" align="center">
														<div id="upload_atch_div2"></div>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</fieldset>
				</form>
			</div>
			<div class="box-footer">
				<button id="btn_close_return3" type="button"
					class="btn btn-primary-gray pull-right"
					onclick='javascript:showOrHideDetail(false, 3);'
					style="margin-right: 15px;">
					<i class="glyphicon glyphicon-repeat"></i>返回
				</button>
				<button id="btn_close_return4" type="button"
					class="btn btn-primary-gray pull-right"
					onclick='javascript:showOrHideDetail(true, 4);'
					style="margin-right: 15px;">
					<i class="glyphicon glyphicon-repeat"></i>返回
				</button>
			</div>
		</div>
	</section>
	<!-- 查询长约提交详细信息 end-->

	<!-- 发起确认提示框 start-->
	<div class="modal fade" id="saveSubmitModal" tabindex="-1"
		role="dialog" aria-labelledby="submitModalLabel" aria-hidden="true">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header" align="center">
					<h4 class="modal-title">友情提示</h4>
					<button type="button" class="close" data-dismiss="modal"
						aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
				</div>
				<div class="modal-body" align="center">确定发票已经开具吗?</div>
				<div class="modal-footer" align="center">
					<button type="button" onclick="javascript:save()" class="btn"
						data-dismiss="modal">确定</button>
					<button type="button" class="btn" data-dismiss="modal">取消</button>
				</div>
			</div>
			<!-- /.modal-content -->
		</div>
		<!-- /.modal-dialog -->
	</div>
	<!-- 发起确认提示框 end -->
	<!-- 长约提交确认提示框 start -->
	<div class="modal fade" id="submitArModal" tabindex="-1" role="dialog"
		aria-labelledby="submitModalLabel" aria-hidden="true">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header" align="center">
					<h4 class="modal-title">友情提示</h4>
					<button type="button" class="close" data-dismiss="modal"
						aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
				</div>
				<div class="modal-body" align="center" id="saveSubmitModalTips">提交后将自动流转到下一环节，若需修改需要下一环节退回，确定提交吗?</div>
				<div class="modal-footer" align="center">
					<button type="button" onclick="javascript:submitAr()"
						class="btn btn-primary-red" data-dismiss="modal">
						<i class="glyphicon glyphicon-ok-sign"></i>确定
					</button>
					<button type="button" class="btn btn-primary-gray"
						data-dismiss="modal">
						<i class="glyphicon glyphicon-remove-sign"></i>取消
					</button>
				</div>
			</div>
			<!-- /.modal-content -->
		</div>
		<!-- /.modal-dialog -->
	</div>
	<!-- 长约提交确认提示框 end -->

	<!-- 长约删除确认提示框 start -->
	<div class="modal fade" id="arUndoModal" tabindex="-1" role="dialog"
		aria-labelledby="submitModalLabel" aria-hidden="true">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header" align="center">
					<h4 class="modal-title">友情提示</h4>
					<button type="button" class="close" data-dismiss="modal"
						aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
				</div>
				<div class="modal-body" align="center">您确定要撤销该长约吗?</div>
				<div class="modal-footer" align="center">
					<button type="button" onclick="javascript:arUndo()"
						class="btn btn-primary-red" data-dismiss="modal">
						<i class="glyphicon glyphicon-ok-sign"></i>确定
					</button>
					<button type="button" class="btn btn-primary-gray"
						data-dismiss="modal">
						<i class="glyphicon glyphicon-remove-sign"></i>取消
					</button>
				</div>
			</div>
			<!-- /.modal-content -->
		</div>
		<!-- /.modal-dialog -->
	</div>
	<!-- 长约删除确认提示框 end -->

	<!-- /.content -->
	<script th:src="@{/resources/plugins/jQuery/jquery-2.2.3.min.js}"></script>
	<script th:src="@{/resources/plugins/bootbox/bootbox.min.js?v=1}"></script>
	<script th:src="@{/resources/bootstrap/js/bootstrap.min.js}"></script>
	<script
		th:src="@{/resources/plugins/bootstrapValidator/bootstrapValidator.min.js}"></script>
	<script th:src="@{/resources/dist/js/app.min.js}"></script>
	<script th:src="@{/resources/e7/e7util-0.2.js}"></script>
	<script th:src="@{/resources/e7/e7table/e7table-0.2.js}"></script>
	<script th:src="@{/resources/e7/e7crud-0.2.js}"></script>
	<script th:src="@{/resources/adminlte/plugins/ckeditor/ckeditor.js}"></script>
	<script
		th:src="@{/resources/plugins/datetimepicker/js/bootstrap-datetimepicker.min.js}"></script>
	<script
		th:src="@{/resources/plugins/datetimepicker/js/locales/bootstrap-datetimepicker.zh-CN.js}"></script>
	<script th:src="@{/resources/js_zcb/tools.js}"></script>
	<script th:src="@{/resources/js_zcb/layer/layer.js}"></script>
	<script type="text/javascript">
	/* 日期选择控件-长约开始日期 */
	$('#arStdtDTPicker').datetimepicker({
        language: 'zh-CN',
        minView: "month",//设置只显示到月份
        format : "yyyy-mm-dd",//日期格式
        autoclose:true,//选中关闭
        todayBtn: true//今日按钮
     }).on('changeDate',function(ev){
         // 判断保险起止时间与长约起止时间，并提示，但是不禁止提交
         checkInsDtAndArDt();
     }); 
	/* 日期选择控件-长约结束日期 */
	$('#arEddtDTPicker').datetimepicker({
        language: 'zh-CN',
        minView: "month",//设置只显示到月份
        format : "yyyy-mm-dd",//日期格式
        autoclose:true,//选中关闭
        todayBtn: true//今日按钮
     }).on('changeDate',function(ev){   
         // 判断保险起止时间与长约起止时间，并提示，但是不禁止提交
         checkInsDtAndArDt(); 
     }); 
	
	
	window.onload=function(){

		}
	
    // 判断保险起止时间与长约起止时间，并提示，但是不禁止提交
	function checkInsDtAndArDt(){
	    var msg = "";
	    if(($('#arStdtDTPicker').val() != "") && ($('#arEddtDTPicker').val() != "")){
		    if($('#arStdtDTPicker').val() > $('#arEddtDTPicker').val()){
		   	 msg += "[开始日期] 晚于 [开始日期] !";
		    }
	
		    if(msg != ""){
					bootbox.alert({
						'title' : '特别提醒',
						'message' : msg
					});
		    }
	    }
	}
		
		var pageSetting = {
			modelName : '发票信息管理',
			resetPath : '[[@{/msgManagement}]]'
		};
		$(function() {
//			var menus = [[${session.loginUser.menus}]];
			//e7table表格控件初始化
			e7tableInit();
			//表单校验控件初始化
			validator_1_Init();
			validator_2_Init();
			buttonInit();
			// 是否投保默认不选中，用户自己选择
//			$("input:radio[name="isNeedIns"]").attr("checked",false);
			CKEDITOR.replace("editor1")

		});

		/***
		 * 查询
		 */
		function query_ar_list() {
			showOrHideDetail(true, 1);
			$('#tbl_query').e7table('query', '#frm_query');

		}		
		function showOrHideDetail(editable, flag) {
			if (editable) {
				$('#fld_detail').prop('disabled', false);
				$('#btn_save').show();
			} else {
				$('#fld_detail').prop('disabled', true);
				$('#btn_save').hide();
			}
			// 长约列表查询
			if(flag == 1){
				$('#main_search_detail').fadeIn(300);
				$('#main_edit_detail').hide();
				$('#ar_lnk_jrnl_inf_detail').hide();
				$('#submit_ar_detail').hide();
				// 返回按钮
				$('#btn_close_div').hide();	
				$('#query_ar_submmit_detail').hide();
			} else if(flag == 2){// 长约发起	
				// section
				$('#main_edit_detail_title').text("长约发起");
				$('#main_edit_detail').fadeIn(300);
				$('#main_search_detail').hide();
				$('#ar_lnk_jrnl_inf_detail').hide();
				$('#submit_ar_detail').hide();
				$('#query_ar_submmit_detail').hide();
				// 返回按钮
				$('#btn_close_div').hide();	
				// 附件
				$('#upload_ar_div').show();
				$('#query_ar_atch_div').hide();
				// 保险信息输入部门默认隐藏
				show_or_hide_ins_div(false);
				// 参数
				$('#arIdDiv').hide();
				// 按钮				
				$('#btn_close').show();
				$('#btn_save').show();
				//面板收缩控制
				var div = document.getElementById('main_edit_detail_clapse'); 
				div.setAttribute("class", "box box-info"); 
				//面板收缩+-号
				div = document.getElementById('main_edit_detail_li'); 
				div.setAttribute("class", "fa fa-minus"); 
			} else if(flag == 3){// 长约详情查看
				//$('#main_edit_detail_title').text("长约信息");
				// section
				// 保险信息输入部门显示隐藏
				show_or_hide_ins_div(true);
				$('#main_edit_detail').fadeIn(300);
				$('#main_search_detail').hide();
				$('#ar_lnk_jrnl_inf_detail').fadeIn(300);
				$('#submit_ar_detail').hide();
				$('#query_ar_submmit_detail').hide();
				// 附件
				$('#upload_ar_div').hide();
//				$('#query_ar_atch_div').show();//改为在查询后控制显示，没有数据的不显示
				// 返回按钮
				$('#btn_close_div').show();
				// 参数
				$('#arIdDiv').show();
				// 按钮	
				$('#btn_close').hide();
				$('#btn_save').hide();
				//面板收缩控制
				var div = document.getElementById('ar_lnk_jrnl_inf_detail_clapse_box'); 
				div.setAttribute("class", "box box-info");
				div = document.getElementById('main_edit_detail_clapse'); 
				div.setAttribute("class", "box box-info"); 
				//面板收缩+-号
				div = document.getElementById('main_edit_detail_li'); 
				div.setAttribute("class", "fa fa-minus"); 
			} else if(flag == 6){// 长约修改
				// section
				$('#main_edit_detail_title').text("长约修改");
				$('#main_edit_detail').fadeIn(300);
				$('#main_search_detail').hide();
				$('#ar_lnk_jrnl_inf_detail').hide();
				$('#submit_ar_detail').hide();
				$('#query_ar_submmit_detail').hide();
				// 返回按钮
				$('#btn_close_div').hide();	
				// 附件
				$('#upload_ar_div').show();
				$('#query_ar_atch_div').hide();
				// 保险信息输入部门默认隐藏
				show_or_hide_ins_div(true);
				// 参数
				$('#arIdDiv').hide();
				// 按钮				
				$('#btn_close').show();
				$('#btn_save').show();
				//面板收缩控制
				var div = document.getElementById('main_edit_detail_clapse'); 
				div.setAttribute("class", "box box-info"); 
				//面板收缩+-号
				div = document.getElementById('main_edit_detail_li'); 
				div.setAttribute("class", "fa fa-minus"); 
			} else if(flag == 4){// 长约提交
				//$('#main_edit_detail_title').text("长约信息");
				// section
				$('#main_edit_detail').fadeIn(300);
				$('#main_search_detail').hide();
//				$('#ar_lnk_jrnl_inf_detail').fadeIn(300);
//				$('#submit_ar_detail').fadeIn(300);
				$('#query_ar_submmit_detail').hide();
				// 附件
				$('#upload_ar_div').show();
				$('#query_ar_atch_div').show();
				// 返回按钮
				$('#btn_close_div').show();
				// 参数
				$('#arIdDiv').show();
				// 按钮
				$('#btn_close').show();
				$('#btn_save').show();
				//面板收缩控制
/* 				var div = document.getElementById('ar_lnk_jrnl_inf_detail_clapse_box'); 
				div.setAttribute("class", "box box-info collapsed-box");
				div = document.getElementById('main_edit_detail_clapse'); 
				div.setAttribute("class", "box box-info collapsed-box"); 
				//面板收缩+-号
				div = document.getElementById('main_edit_detail_li'); 
				div.setAttribute("class", "fa fa-plus"); 
				div = document.getElementById('ar_lnk_jrnl_inf_detail_li'); 
				div.setAttribute("class", "fa fa-plus");  */
			} else if(flag == 5){//长约提交详情查看
				$('#main_search_detail').hide();
				$('#main_edit_detail').hide();
				$('#ar_lnk_jrnl_inf_detail').hide();
				$('#submit_ar_detail').hide();
				// 返回按钮
				$('#btn_close_div').hide();	
				$('#query_ar_submmit_detail').fadeIn(300);	
			}
		}
		/***
		 * 重置
		 */
		function reset() {
			E7.resetForm('#frm_query');
		}
				
		function validate_frm_submit_ar(){
			$('#frm_submit_ar').bootstrapValidator('validate');
			if (!$('#frm_submit_ar').data('bootstrapValidator').isValid()) {
				return;
			} else {	
				var nestStepName = "";
				var aplyPsrltCd = "";
				var aplyPsrltCdRadio = document.getElementsByName("aplyPsrltCd");
				 for(var i=0;i<aplyPsrltCdRadio.length;i++)
				 {
					 if(aplyPsrltCdRadio[i].checked)
						 aplyPsrltCd = aplyPsrltCdRadio[i].value;
				 }	
					
				if("01" ==  aplyPsrltCd){
					nestStepName=getNextStepName($('#aplyPcstpCd').val(),1);
					if(null == nestStepName || ""==nestStepName)
						nestStepName="下一环节";
					$('#saveSubmitModalTips').text("提交后将流转到 [ "+ nestStepName+" ] ，确定提交吗?");
				} else if("02" ==  aplyPsrltCd){
					nestStepName=getNextStepName($('#aplyPcstpCd').val(),2);
					$('#saveSubmitModalTips').text("提交后将退回到 [ "+ nestStepName+" ] ，确定提交吗?");
				}
				$('#submitArModal').modal('show');
			}
		}
		
		function getNextStepName(currStep, flag){
			// currStep,当前环节；flag，跳转方向1通过，2退回
			var nextStepName = "";
			if("01" == currStep){
				if(1==flag) nextStepName="长约确认(供应链)";
				else if(2==flag) nextStepName="";
			} else if("02" == currStep){
				if(1==flag) nextStepName="长约确认(融资企业)";
				else if(2==flag) nextStepName="长约发起（平台）";
			}  else if("03" == currStep){
				if(1==flag) nextStepName="确认承保（保险公司）";
				else if(2==flag) nextStepName="长约确认(供应链)";
			} else if("04" == currStep){
				if(1==flag) nextStepName="长约一审（平台）";
				else if(2==flag) nextStepName="长约确认(融资企业)";
			} else if("05" == currStep){
				if(1==flag) nextStepName="长约二审（平台）";
				else if(2==flag) nextStepName="确认承保（保险公司）";
			} else if("06" == currStep){
				if(1==flag) nextStepName="长约终止（平台）";
				else if(2==flag) nextStepName="长约一审（平台）";
			} else if("07" == currStep){
				if(1==flag) nextStepName="长约结束";
				else if(2==flag) nextStepName="长约二审（平台）";
			}	
			return nextStepName;
		}
		
		/***
		 * 长约提交
		 */
		function submitAr() {			
			for (instance in CKEDITOR.instances) {
				CKEDITOR.instances[instance].updateElement();
			}
			var formParams = E7.serialForm('#frm_submit_ar');
			E7.post(pageSetting.resetPath + '/submitAr', formParams, function(
					data) {
				showOrHideDetail(true, 1);
				bootbox.alert({
					'title' : "消息",
					'message' : '提交成功！'
				});
				$('#tbl_query').e7table(
						'reload',
						function() {
							if (formParams['id'] != '') {
								$('#tbl_query').e7table('selectById',
										formParams['id']);
							}
						});
			});
		}

		/***
		 * 显示发起对话框
		 */
		function showAddDialog() {
			// 初始化上传附件控件
			initInputItem(1);
			E7.resetForm('#frm_detail');
			//		CKEDITOR.instances.editor1.setData('');
			$('#frm_detail').data('bootstrapValidator').resetForm(true);
			showOrHideDetail(true, 2);
		}
		
		/***
		 * 表单校验控件初始化2(长约各环节提交)
		 */
		function validator_2_Init() {			
			$('#frm_submit_ar').bootstrapValidator({
				feedbackIcons : {
					valid : 'glyphicon glyphicon-ok',
					invalid : 'glyphicon glyphicon-remove',
					validating : 'glyphicon glyphicon-refresh'
				},
				fields : {
			    	"aplyPsrltCd" : {
						validators : {
							notEmpty : {message : '处理结果不能为空'}
						}
					}
				}
			});

			$('#btn_submit_ar').click(function() {
				$('#frm_submit_ar').bootstrapValidator('validate');
			});
		}
		/***
		 * 表单校验控件初始化1（长约发起提交）
		 */
		function validator_1_Init() {						
			$('#frm_detail').bootstrapValidator({
				feedbackIcons : {
					valid : 'glyphicon glyphicon-ok',
					invalid : 'glyphicon glyphicon-remove',
					validating : 'glyphicon glyphicon-refresh'
				},
				fields : {
			    	
			    	"isNeedIns" : {
						validators : {
							notEmpty : {message : '投保类型不能为空'}
						}
					}
				}
			});

			$('#btn_save').click(function() {
				$('#frm_detail').bootstrapValidator('validate');
			});
		}
 
		function queryArDetails(id){
			// 带过来的环节编号
	//		$('#frm_submit_ar [name="aplyPcstpCd"]').val(aplyPcstpCd);

			if ($('#frm_detail').data('bootstrapValidator')) {
				$('#frm_detail').data('bootstrapValidator').resetForm(true);
			}
			E7.post(pageSetting.resetPath + '/getDetail', {
				'id' : id
			}, function(result) {
				fillForm('#frm_detail', result.data);
				var detail = result.data;
				for (key in detail) {
					// 日期时间格式的转换
					if(key == "msgSndTm")
						$('#frm_detail [name="' + key + '"]').val(transDateTime(detail[key]));
					else{
						$('#frm_detail [name="' + key + '"]').val(detail[key]);
						//alert(key + detail[key]);
					}
				}
				
				$('#saveSubmitModal').modal('show');
				/* alert($("#msgSndTm").val());
				var msgContent = document.getElementById('msg_content_div').innerHTML;
				alert(msgContent);
				layer.open({
					type: 1,
					skin: 'layui-layer-rim', //加上边框
					shadeClose: true,
					shade: false,
					maxmin: true, //开启最大化最小化按钮
					area: ['580px', '390px'],
					title: '信息详情',
					content: msgContent
				}); */
				
/* 				// 根据角色不同控制数据展示
				var datas = detail["roleParmsList"];
				if (null != datas) {
					for (var i = 0; i < datas.length; i++) {
						// 控制界面控件是否显示
						$('#' + datas[i] + '_div').hide();
					}
				} */				
				
				///附件列表
/* 				var td = detail["t2UploadAtch01List"];
				$('#query_ar_atch_div').hide();	
				var insertHtml="";
				for ( var kk = 0; kk < td.length; kk++) {
					insertHtml = insertHtml + '<div class="col-sm-2"><i class="iconfont icon-kl-fujian"></i><a href="'+ td[kk].srFileRte +'" target="_blank"><div>'+td[kk].oriFileNm+'<p>'+getFileType(td[kk].oriFileNm)+'</div></a></div>';
				}
				if(td.length > 0){
					var testdiv = document.getElementById("upload_atch_div");
					testdiv.innerHTML=insertHtml;
					$('#query_ar_atch_div').fadeIn(300);
				} else {
					$('#query_ar_atch_div').hide();	
				}	 */			


			});
		}
				
		
			function getArSubmmitDetail(id, arId, aplyPcstpCd){
 			// 带过来的环节编号
			E7.post(pageSetting.resetPath + '/getArSubmmitDetail', {
				'id' : id,'arId':arId,'aplyPcstpCd':aplyPcstpCd
			}, function(result) {
//				fillForm('#frm_detail2', result.data);
				var detail = result.data;
/* 				$('#frm_detail2 [name="submmitUsername"]').val(detail["username"]);
				$('#frm_detail2 [name="companyName"]').val(detail["name"]);
				$('#frm_detail2 [name="aplyPcstpCdDesc"]').val(transAplyPcstpCd(detail["aplyPcstpCd"]));
				$('#frm_detail2 [name="lnkEdtm"]').val(transDateTime(detail["lnkEdtm"]));
				$('#frm_detail2 [name="aplyPsrltCdDesc"]').val(transAplyPsrltCd(detail["aplyPsrltCd"]));
				$('#frm_detail2 [name="rmrkDesc"]').val(detail["rmrk"]); */
				document.getElementById('companyName').innerText = "公    司    :    " + detail["name"];
				document.getElementById('submmitUsername').innerText = "提交人    :    " + detail["username"];
				document.getElementById('aplyPcstpCdDesc').innerText = "环    节    :    " + transAplyPcstpCd(detail["aplyPcstpCd"]);
				document.getElementById('lnkEdtm').innerText = "时    间    :    " + transDateTime(detail["lnkEdtm"]);
				document.getElementById('aplyPsrltCdDesc').innerText = "结    果    :    " + transAplyPsrltCd(detail["aplyPsrltCd"]);
				document.getElementById('rmrkDesc').innerText = "备    注    :    " + detail["rmrk"];
				///附件列表
				var td = detail["t2UploadAtch01List"];
				var insertHtml="";
				for ( var kk = 0; kk < td.length; kk++) {
					insertHtml = insertHtml + '<div class="col-sm-2"><i class="iconfont icon-kl-fujian"></i><a href="'+ td[kk].srFileRte +'" target="_blank"><div>'+td[kk].oriFileNm+'<p>'+getFileType(td[kk].oriFileNm) + transDateTime(suffix) +'</div></a></div>';
				}								
				if(td.length > 0){
					var testdiv = document.getElementById("upload_atch_div2");
					testdiv.innerHTML=insertHtml;
					$('#query_ar_atch_div2').fadeIn(300);
				} else {
					$('#query_ar_atch_div2').hide();	
				}				
				showOrHideDetail(false,5);
			}); 
		}                                                                                
				
		function transAplyPsrltCd(aplyPsrltCd) {
			if (aplyPsrltCd == '01') {
				return "通过";
			} else if (aplyPsrltCd == '02') {
				return "退回";
			} else if (aplyPsrltCd == '03') {
				return "拒绝";
			}  else
				return aplyPsrltCd;
		}
		
		function transAplyPcstpCd(value) {
			if (value == '01') {
				return "发起";
			} else if (value == '02') {
				return "供应链确认";
			} else if (value == '03') {
				return "融资企业确认";
			} else if (value == '04') {
				return "承保";
			} else if (value == '05') {
				return "一审";
			} else if (value == '06') {
				return "二审";;
			} else if (value == '07') {
				return "终止";
			} else if (value == '') {
				return "完成";
			} else
				return value;
		}	
		
		function showViewSubmitAr(id) {
 
			// 初始化上传附件控件
		//	initInputItem(2); 
			queryArDetails(id);// 
	//		showOrHideDetail(true, 4);
		}	
		function showArDetailDialog() {
			var rows = $('#tbl_query').e7table('getSelectedRows');
			if (rows.length == 0) {
				bootbox.alert({
					'title' : '错误消息',
					'message' : '请选择数据！'
				});
				return;
			} else if (rows.length > 1) {
				bootbox.alert({
					'title' : '错误消息',
					'message' : '一次只能修改一条数据！'
				});
				return;
			}
			if ($('#frm_detail').data('bootstrapValidator')) {
				$('#frm_detail').data('bootstrapValidator').resetForm(true);
			}
			queryArDetails(rows[0]['id'], "", 0);// flag 1:长约提交  0：长约详情查询
	//		showOrHideDetail(true, 3);
		}
		
		function confirmArUndo(){
			$('#arUndoModal').modal('show');
		}
		
		function arUndo() {
			var rows = $('#tbl_query').e7table('getSelectedRows');
			if (rows.length == 0) {
				bootbox.alert({
					'title' : '错误消息',
					'message' : '请选择数据！'
				});
				return;
			} else if (rows.length > 1) {
				bootbox.alert({
					'title' : '错误消息',
					'message' : '一次只能撤销一条长约！'
				});
				return;
			}
			if ($('#frm_detail').data('bootstrapValidator')) {
				$('#frm_detail').data('bootstrapValidator').resetForm(true);
			}
			E7.post(pageSetting.resetPath + '/unDoAr', {
				'id' : rows[0]['id']
			}, function(result) {
				query_ar_list();
				bootbox.alert({
					'title' : "消息",
					'message' : '长约撤销成功!'
				});
			});
		}
		
		function del() {
			var rows = $('#tbl_query').e7table('getSelectedRows');
			if (rows.length == 0) {
				bootbox.alert({
					'title' : '错误消息',
					'message' : '请选择数据！'
				});
				return;
			} else if (rows.length > 1) {
				bootbox.alert({
					'title' : '错误消息',
					'message' : '一次只能修改一条数据！'
				});
				return;
			}
			if ($('#frm_detail').data('bootstrapValidator')) {
				$('#frm_detail').data('bootstrapValidator').resetForm(true);
			}
			E7.post(pageSetting.resetPath + '/deleteAr', {
				'id' : rows[0]['id']
			}, function(result) {
				query_ar_list();
				bootbox.alert({
					'title' : "消息",
					'message' : '删除成功！'
				});
			});
		}

		function validate_frm_detail(){
/* 			$('#frm_detail').bootstrapValidator('validate');
			if (!$('#frm_detail').data('bootstrapValidator').isValid()) {
				return;
			} else { */
				$('#saveSubmitModal').modal('show');
/* 			} */
		}
		

		
		function save() {			
			for (instance in CKEDITOR.instances) {
				CKEDITOR.instances[instance].updateElement();
			}

			var formParams = E7.serialForm('#frm_detail');
			E7.post(pageSetting.resetPath + '/save_dk', formParams,
					function(data) {
						query_ar_list();
						//showOrHideDetail(true, 1);
						bootbox.alert({
							'title' : "消息",
							'message' : '设置发票已收成功！'
						});
						$('#tbl_query').e7table(
								'reload',
								function() {
									if (formParams['id'] != '') {
										$('#tbl_query').e7table('selectById',
												formParams['id']);
									}
								});
					});
		}
		function showEditDialog(disable) {
			var rows = $('#tbl_query').e7table('getSelectedRows');
			if (rows.length == 0) {
				bootbox.alert({
					'title' : '错误消息',
					'message' : '请选择数据！'
				});
				return;
			} else if (rows.length > 1) {
				bootbox.alert({
					'title' : '错误消息',
					'message' : '一次只能修改一条数据！'
				});
				return;
			}
			if ($('#frm_detail').data('bootstrapValidator')) {
				$('#frm_detail').data('bootstrapValidator').resetForm(true);
			}
			E7
					.post(
							pageSetting.resetPath + '/getDetail',
							{
								'id' : rows[0]['id']
							},
							function(result) {
								fillForm('#frm_detail', result.data);
								// 实时判断长约是否可以修改	
								if(result.data["aplyPcstpCd"] != "01"){
									bootbox.alert({
										'title' : '错误消息',
										'message' : '当前长约不在发起环节禁止修改！请退回到发起环节再修改。'
									});
									return;
								}
								// 多次修改，清空上次div追加的内容
								$("#fujianId").empty(); 
 								if (result.data.t2UploadAtch01List != undefined) {
									for (i = 0; i < result.data.t2UploadAtch01List.length; i++) {
										var elem = result.data.t2UploadAtch01List[i];
/* 										var item = '<div name="inputDiv">'
												+ elem.oriFileNm
												+ '<input name="fileName" type="file" src="'+elem.oriFileNm+'"  class="form-control" value="'+elem.oriFileNm+'"/><a onclick="deleteItem(this)">删除</a> <br/></div>'; */
										var atchId = elem.id;
												var item = '<div name="inputDiv"> <a href="' + elem.srFileRte +'" target="_blank">'+elem.oriFileNm  +'&nbsp&nbsp</a>&nbsp&nbsp<a onclick="deleteItem2(this, ' + elem.id +')"> 删除</a> <br/></div>';
												
												$("#fujianId").append(item);
									}
								} 
								showOrHideDetail(true, 6);
								// 展示保险div
								show_or_hide_ins_div(true);
							});
		}
		fillForm = function(frm, data, reset, parent) {
			if (E7.isEmpty(parent)
					&& (E7.getType(reset) == 'undefined' || reset))
				E7.resetForm(frm);
			for ( var key in data) {
				var elName = E7.isEmpty(parent) ? key : (parent + '.' + key);
				var elValue = data[key];

				if (elValue == null)
					continue;
				if (E7.getType(elValue) == 'object') {
					E7.fillForm(frm, elValue, false, elName);
					continue;
				}
				var els = $(frm + ' [name="' + elName + '"]');
				if (els.length == 0)
					continue;
				if (els[0].type == 'radio') {
					$(frm + ' [name="' + elName + '"][value="' + elValue + '"]')
							.prop("checked", true);
				} else if (els[0].type == 'select-multiple') {
					if (elValue instanceof Array) {
						els.val(elValue);
					} else if (typeof elValue == 'string') {
						els.val(elValue.split(','));
					} else if (typeof elValue == 'number') {
						els.val(elValue + '');
					} else {
						els.val(elValue);
					}
				} else if (els[0].type == 'checkbox') {
					if (els.length == 1) {
						if (els.val() == elValue) {
							els.prop('checked', true);
						}
					} else {
						if (elValue instanceof Array) {
							els.val(elValue);
						} else if (typeof elValue == 'string') {
							els.val(elValue.split(','));
						} else if (typeof elValue == 'number') {
							els.val(elValue + '');
						} else {
							els.val(elValue);
						}
					}
				} else if (els[0].id == 'editor1') {
					CKEDITOR.instances.editor1.setData(elValue);
				} else {
					els.val(elValue + '');
				}
			}
		}

		function submitTransferFile(flag) {
			if(flag == 1){			
			var file = document.getElementsByName("fileName")
			//var file = $('.select-file').files//document.getElementById("file_transfer").files;
			//TODO:valid
			var formData = new FormData();
			for (i = 0; i < file.length; i++) {
				formData.append('file', file[i].files[0]);
			}
			E7.postMultipart('[[@{/arManagement/ossUpload}]]', formData,
					function(result) {
						var fileUrl = result.data;
						$("#fileId").val(fileUrl);
						bootbox.alert({
							'title' : '消息',
							'message' : '上传成功, 文件：<code>' + result.data
									+ '</code>！'
						});
					});
			} else if(flag == 2){
				var file = document.getElementsByName("fileName2")
				//var file = $('.select-file').files//document.getElementById("file_transfer").files;
				//TODO:valid
				var formData = new FormData();
				for (i = 0; i < file.length; i++) {
					formData.append('file', file[i].files[0]);
				}
				E7.postMultipart('[[@{/arManagement/ossUpload}]]', formData,
						function(result) {
							var fileUrl2 = result.data;
							$("#fileId2").val(fileUrl2);
							bootbox.alert({
								'title' : '消息',
								'message' : '上传成功, 文件：<code>' + result.data
										+ '</code>！'
							});
						});
			}
		}

		function addInputItem(flag) {

			if(flag == 1){
				var item = '<div name="inputDiv"><input name="fileName" type="file"  class="form-control"/><a onclick="deleteItem(this)">删除</a> <br/></div>';
				$("#fujianId").append(item);
			} else if (flag == 2){
				var item = '<div name="inputDiv"><input name="fileName2" type="file"  class="form-control"/><a onclick="deleteItem(this)">删除</a> <br/></div>';
				$("#fujianId2").append(item);
			}
		}
		function initInputItem(flag) {
			
			if(flag ==1 ){
				var item = '<div name="inputDiv"><input name="fileName" type="file"  class="form-control"/><a onclick="deleteItem(this)">删除</a> <br/></div>';
				var testdiv = document.getElementById("fujianId");
				testdiv.innerHTML=item;
			} else if(flag == 2){
				var item = '<div name="inputDiv"><input name="fileName2" type="file"  class="form-control"/><a onclick="deleteItem(this)">删除</a> <br/></div>';
				var testdiv = document.getElementById("fujianId2");
				testdiv.innerHTML=item;
			}
		}
		function deleteItem(input) {
			$(input).parent().remove();
		}
		function deleteItem2(input, id) {
			var preValue = $("#fileToDeleteId").val();
			if(preValue == null || preValue == "")
				$("#fileToDeleteId").val(id);
			else				
				$("#fileToDeleteId").val(preValue + "||" + id);

			$(input).parent().remove();
		}
		
		
		function buttonInit() {
			if ('[[${userType}]]' == 'Group') {
				/* 	$("#div_buttons")
				.append(
					 '<button type="button" class="btn btn-primary-red btn-sm" onclick="javascript:showAddDialog();" style="margin-right:5px;"><i class="glyphicon glyphicon-plus"></i>发起</button>'		
				);				 
		$("#div_buttons")
				.append(
					'<button type="button" class="btn btn-primary-red btn-sm" onclick="javascript:showEditDialog();" style="margin-right:5px;"><i class="glyphicon glyphicon-edit"></i>修改</button>');
		$("#div_buttons")
				.append(
					'<button id="btn_search" class="btn btn-primary-gray btn-sm" type="button" class="btn btn-primary pull-right" onclick="javascript:showArDetailDialog();" style="margin-right:5px;"><i class="glyphicon glyphicon-search"></i>查看</button>');
		$("#div_buttons")
				.append(
					 '<button type="button" class="btn btn-primary-red btn-sm" id="btn-del" onclick="javascript:del();"><i class="glyphicon glyphicon-trash"></i>删除</button>');
 */		
/*  $("#div_buttons")
	.append(
		 '<button type="button" class="btn btn-primary-red btn-sm" onclick="javascript:confirmArUndo();" style="margin-left:20px;"><i class="glyphicon glyphicon-minus-sign"></i>撤销</button>'		
	); */
 $("#div_buttons")
	.append(
			/* '<button class="btn btn-default pull-right" onclick="javascript:reset()">重置</button>'); */
		'<button type="button" class="btn btn-sm btn-primary-gray pull-right" onclick="javascript:reset()"><i class="glyphicon glyphicon-refresh"></i>重置</button>');
		$("#div_buttons")
			.append(
					/* '<button class="btn btn-primary pull-right" onclick="javascript:query_ar_list()" style="margin-right:15px;">查询</button>'); */
		'<button id="btn_search"  type="button" class="btn btn-primary-gray btn-sm pull-right" onclick="javascript:query_ar_list()" style="margin-right:15px;"><i class="glyphicon glyphicon-search"></i>查询</button>');
			} else {
				$("#div_buttons")
						.append(
								'<button class="btn btn-default" onclick="javascript:showViewDialog1();">查看33</button>');
				$("#div_buttons")
						.append(
								'<button class="btn btn-default pull-right" onclick="javascript:reset()">重置</button>');
				$("#div_buttons")
						.append(
								'<button class="btn btn-primary pull-right" onclick="javascript:query_ar_list()" style="margin-right:15px;">查询</button>');
			}
		}
		/***
		 * e7table表格控件初始化
		 */
		function e7tableInit() {
			$('#tbl_query')
					.e7table(
							{
								url : '[[@{/msgManagement/queryPage}]]',
								pageSize : 10,
								autoLoading : true, //控件初始化后，自动远程请求数据
								selectType : 'single',
								sortName : '', //排序列名,创建时间
								striped: false, //奇偶行不同背景
								pagination: true,
								rownumbers: false,		//如果为true，则显示一个行号列
								sortOrder : 'desc', //排序方向
								columns : [
										{
											title : '发件人',
											field : 'sndPsnUserName',
											sortable : false
										},
 										{
											title : '收件人',
											field : 'rcvPsnList',
											sortable : true
										},
										{
											title : '类型',
											field : 'msgTpcd',
											sortable : true
										},
										{
											title : '标题',
											field : 'msgTitle',
											sortable : true
										},
										{
											title : '发送时间',
											field : 'msgSndTm',
											sortable : true,
											formatter : function(value, row,
													index) {
												return transDateTime(value);
											}
										}
										],
								onDblclick : function(index, row) {
									showViewSubmitAr(row.id);
								}
							});
		}		
		function show_or_hide_ins_div(flag){
			if(flag){
				document.getElementById('ins_div').style.display="";
			} else {
				document.getElementById('ins_div').style.display="none";
			}
		}
		// 引入日期时间格式转换
		Date.prototype.Format = function(fmt)   
		 { 
		//author:wangweizhen
		   var o = {   
		     "M+" : this.getMonth()+1,                 //月份   
		     "d+" : this.getDate(),                    //日
		    "h+" : this.getHours(),                   //小时   
		     "m+" : this.getMinutes(),                 //分   
		     "s+" : this.getSeconds(),                 //秒   
		     "q+" : Math.floor((this.getMonth()+3)/3), //季度   
		     "S"  : this.getMilliseconds()             //毫秒   
		   };   
		   if(/(y+)/.test(fmt))   
		     fmt=fmt.replace(RegExp.$1, (this.getFullYear()+"").substr(4 - RegExp.$1.length));   
		   for(var k in o)   
		     if(new RegExp("("+ k +")").test(fmt))   
		   fmt = fmt.replace(RegExp.$1, (RegExp.$1.length==1) ? (o[k]) : (("00"+ o[k]).substr((""+ o[k]).length)));   
		   return fmt;   
		 }; 
		 // js 一串数字1403149534转换为日期格式 
		function transDateTime(timestamp){
			var date = new Date(timestamp);    //根据时间戳生成的时间对象
	        return date.format("yyyy-MM-dd hh:mm:ss");
        }
	</script>
</body>
</html>
